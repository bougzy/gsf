<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GSAMS - GeoSecure Attendance Management System</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- AOS Animation Library -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    
    <!-- QR Code library -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        :root {
            --primary-color: #4361ee;
            --secondary-color: #3f37c9;
            --success-color: #4cc9f0;
            --danger-color: #f72585;
            --warning-color: #f8961e;
            --dark-color: #212529;
            --light-color: #f8f9fa;
            --gray-color: #6c757d;
            --border-radius: 12px;
            --box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f5f7fb;
            color: var(--dark-color);
            line-height: 1.6;
            overflow-x: hidden;
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--secondary-color);
        }
        
        /* Navbar */
        .navbar-brand {
            font-weight: 700;
            font-size: 1.8rem;
            color: var(--primary-color) !important;
        }
        
        .navbar-brand i {
            color: var(--success-color);
        }
        
        .navbar {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            padding: 1rem 0;
            transition: var(--transition);
        }
        
        .navbar.scrolled {
            padding: 0.7rem 0;
            background-color: white !important;
        }
        
        .nav-link {
            font-weight: 500;
            margin: 0 0.5rem;
            transition: var(--transition);
        }
        
        .nav-link:hover {
            color: var(--primary-color) !important;
        }
        
        /* Hero Section */
        .hero-section {
            background: linear-gradient(135deg, #4361ee 0%, #3f37c9 100%);
            color: white;
            padding: 8rem 0 6rem;
            position: relative;
            overflow: hidden;
        }
        
        .hero-section::before {
            content: '';
            position: absolute;
            width: 300px;
            height: 300px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            top: -150px;
            right: -100px;
        }
        
        .hero-section::after {
            content: '';
            position: absolute;
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.05);
            bottom: -100px;
            left: -50px;
        }
        
        .hero-title {
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            line-height: 1.2;
        }
        
        .hero-subtitle {
            font-size: 1.2rem;
            margin-bottom: 2rem;
            opacity: 0.9;
            max-width: 600px;
        }
        
        .hero-btns {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        /* Features Section */
        .section-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            position: relative;
            display: inline-block;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            width: 70px;
            height: 4px;
            background: var(--primary-color);
            bottom: -10px;
            left: 0;
            border-radius: 2px;
        }
        
        .section-subtitle {
            color: var(--gray-color);
            max-width: 700px;
            margin: 0 auto 4rem;
        }
        
        .feature-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 2rem;
            height: 100%;
            transition: var(--transition);
            box-shadow: var(--box-shadow);
            border: 1px solid #eee;
        }
        
        .feature-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.12);
        }
        
        .feature-icon {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1.5rem;
            color: white;
            font-size: 1.8rem;
        }
        
        .feature-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }

        /* Add these styles to your existing CSS */

/* Meeting table enhancements */
.meeting-actions {
    display: flex;
    gap: 4px;
}

.meeting-actions .btn {
    padding: 0.25rem 0.5rem;
    font-size: 0.75rem;
}

/* Validation progress indicator */
.validation-indicator {
    width: 60px;
    height: 5px;
    background: #e9ecef;
    border-radius: 3px;
    overflow: hidden;
    margin-top: 2px;
}

.validation-progress {
    height: 100%;
    background: linear-gradient(90deg, #4cc9f0, #4361ee);
    transition: width 0.3s ease;
}

/* Success modal animations */
@keyframes bounceIn {
    from {
        opacity: 0;
        transform: scale(0.5);
    }
    to {
        opacity: 1;
        transform: scale(1);
    }
}

.success-icon {
    animation: bounceIn 0.6s ease;
}

/* Section validation states */
.form-section.valid {
    border-left: 4px solid #28a745;
    padding-left: 1rem;
}

.form-section.invalid {
    border-left: 4px solid #dc3545;
    padding-left: 1rem;
}

/* Required field indicator */
.required-field::after {
    content: " *";
    color: #dc3545;
}

/* Disabled button styling */
.btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}

/* Meeting table highlight */
.table-success {
    background-color: rgba(40, 167, 69, 0.1) !important;
    transition: background-color 0.5s ease;
}

/* Section completion check */
.section-complete {
    color: #28a745;
}

.section-incomplete {
    color: #dc3545;
}
        
        /* Buttons */
        .btn-primary-custom {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border: none;
            color: white;
            padding: 0.8rem 2rem;
            border-radius: 50px;
            font-weight: 600;
            transition: var(--transition);
            box-shadow: 0 5px 15px rgba(67, 97, 238, 0.3);
        }
        
        .btn-primary-custom:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(67, 97, 238, 0.4);
            color: white;
        }
        
        .btn-outline-custom {
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
            padding: 0.8rem 2rem;
            border-radius: 50px;
            font-weight: 600;
            transition: var(--transition);
            background: transparent;
        }
        
        .btn-outline-custom:hover {
            background: var(--primary-color);
            color: white;
            transform: translateY(-3px);
        }
        
        /* Auth Pages */
        .auth-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            background: linear-gradient(135deg, #f5f7fb 0%, #eef2ff 100%);
        }
        
        .auth-card {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 3rem;
            width: 100%;
            max-width: 500px;
        }
        
        .auth-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: var(--primary-color);
        }
        
        .auth-subtitle {
            color: var(--gray-color);
            margin-bottom: 2rem;
        }
        
        /* Dashboard */
        .dashboard-container {
            min-height: 100vh;
            background-color: #f5f7fb;
        }
        
        .sidebar {
            background: white;
            min-height: 100vh;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.05);
            position: fixed;
            width: 260px;
            transition: var(--transition);
            z-index: 100;
        }
        
        .sidebar-header {
            padding: 1.5rem;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .sidebar-logo {
            font-weight: 700;
            font-size: 1.5rem;
            color: var(--primary-color);
        }
        
        .sidebar-menu {
            padding: 1.5rem 0;
        }
        
        .sidebar-item {
            padding: 0.8rem 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            color: var(--dark-color);
            text-decoration: none;
            transition: var(--transition);
            border-left: 4px solid transparent;
            cursor: pointer;
        }
        
        .sidebar-item:hover, .sidebar-item.active {
            background-color: #f0f4ff;
            color: var(--primary-color);
            border-left-color: var(--primary-color);
        }
        
        .sidebar-item i {
            width: 20px;
        }
        
        .main-content {
            margin-left: 260px;
            padding: 2rem;
            transition: var(--transition);
        }
        
        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            background: white;
            padding: 1.5rem;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }
        
        .page-title {
            font-size: 1.8rem;
            font-weight: 600;
            margin: 0;
        }
        
        .user-menu {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }
        
        .user-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }
        
        /* Stats Cards */
        .stats-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
            border: 1px solid #eee;
        }
        
        .stats-card:hover {
            transform: translateY(-5px);
        }
        
        .stats-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }
        
        .stats-number {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .stats-title {
            color: var(--gray-color);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        /* Tables */
        .table-container {
            background: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--box-shadow);
        }
        
        .table-header {
            padding: 1.5rem;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        /* Forms */
        .form-control, .form-select {
            border-radius: 10px;
            padding: 0.8rem 1rem;
            border: 1px solid #ddd;
            transition: var(--transition);
        }
        
        .form-control:focus, .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.25rem rgba(67, 97, 238, 0.25);
        }
        
        .form-label {
            font-weight: 500;
            margin-bottom: 0.5rem;
        }
        
        /* Badges */
        .badge-custom {
            padding: 0.4rem 0.8rem;
            border-radius: 50px;
            font-weight: 500;
            font-size: 0.8rem;
        }
        
        /* Modal */
        .modal-custom {
            border-radius: var(--border-radius);
            overflow: hidden;
        }
        
        .modal-header-custom {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 1.5rem;
        }
        
        /* Toggle Sidebar Button */
        .toggle-sidebar {
            display: none;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--primary-color);
        }
        
        /* New styles for meeting sharing features */
        .share-section {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: var(--border-radius);
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid #dee2e6;
        }
        
        .share-link-container {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            border: 1px solid #e0e0e0;
        }
        
        .share-link {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 1rem;
            font-family: monospace;
            word-break: break-all;
            font-size: 0.9rem;
            border: 1px dashed #ccc;
        }
        
        .qr-code-container {
            text-align: center;
            padding: 1.5rem;
            background: white;
            border-radius: 10px;
            border: 1px solid #e0e0e0;
        }
        
        .qr-code-canvas {
            max-width: 250px;
            height: auto;
            margin: 0 auto;
        }
        
        .form-builder-container {
            background: white;
            border-radius: var(--border-radius);
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid #eee;
            box-shadow: var(--box-shadow);
        }
        
        .form-field-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            border: 1px solid #dee2e6;
            transition: var(--transition);
        }
        
        .form-field-item:hover {
            background: #e9ecef;
        }
        
        .field-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }
        
        .preview-form {
            background: white;
            border-radius: 10px;
            padding: 2rem;
            border: 2px dashed #dee2e6;
        }
        
        /* Modal adjustments for new features */
        .modal-xl {
            max-width: 1200px;
        }
        
        /* Real-time monitoring styles */
        .monitoring-panel {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .live-badge {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .location-marker {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 5px;
        }
        
        .location-good { background-color: #28a745; }
        .location-fair { background-color: #ffc107; }
        .location-poor { background-color: #dc3545; }
        
        .time-indicator {
            height: 6px;
            border-radius: 3px;
            margin-top: 5px;
            background: linear-gradient(90deg, #28a745 0%, #ffc107 50%, #dc3545 100%);
        }
        
        /* PWA Install Button */
        .pwa-install-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            display: none;
        }
        
        /* Attendance card styles */
        .attendance-card {
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
        }
        
        .attendance-card.gps { border-left-color: #4361ee; }
        .attendance-card.sms { border-left-color: #20c997; }
        .attendance-card.ussd { border-left-color: #fd7e14; }
        .attendance-card.kiosk { border-left-color: #6f42c1; }
        .attendance-card.manual { border-left-color: #17a2b8; }
        
        /* Confidence indicator */
        .confidence-bar {
            height: 8px;
            border-radius: 4px;
            background: #e9ecef;
            overflow: hidden;
        }
        
        .confidence-fill {
            height: 100%;
            transition: width 0.5s ease;
        }
        
        /* Export buttons */
        .export-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }
        
        .export-card {
            text-align: center;
            padding: 2rem 1rem;
            border-radius: var(--border-radius);
            background: white;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
        }
        
        .export-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }
        
        /* Responsive */
        @media (max-width: 992px) {
            .sidebar {
                transform: translateX(-100%);
                width: 280px;
            }
            
            .sidebar.active {
                transform: translateX(0);
                box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            }
            
            .main-content {
                margin-left: 0;
                padding: 1rem;
            }
            
            .toggle-sidebar {
                display: block;
            }
            
            .hero-title {
                font-size: 2.8rem;
            }
            
            /* Overlay for sidebar on mobile */
            .sidebar-overlay {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.5);
                z-index: 99;
            }
            
            .sidebar-overlay.active {
                display: block;
            }
        }
        
        @media (max-width: 768px) {
            .hero-title {
                font-size: 2.2rem;
            }
            
            .section-title {
                font-size: 2rem;
            }
            
            .auth-card {
                padding: 2rem;
            }
            
            .top-bar {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }
            
            .user-menu {
                align-self: flex-end;
            }
            
            .export-options {
                grid-template-columns: 1fr;
            }
        }
        
        /* Loading Spinner */
        .spinner-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            width: 100%;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Animations */
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* Footer */
        .footer {
            background: var(--dark-color);
            color: white;
            padding: 4rem 0 2rem;
        }
        
        .footer-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
        }
        
        .footer-links {
            list-style: none;
            padding: 0;
        }
        
        .footer-links li {
            margin-bottom: 0.8rem;
        }
        
        .footer-links a {
            color: #ccc;
            text-decoration: none;
            transition: var(--transition);
        }
        
        .footer-links a:hover {
            color: white;
            padding-left: 5px;
        }
        
        .copyright {
            text-align: center;
            padding-top: 2rem;
            margin-top: 2rem;
            border-top: 1px solid #444;
            color: #aaa;
            font-size: 0.9rem;
        }
        
        /* Toast Notifications */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
        }
        
        .toast-custom {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
            border-left: 5px solid var(--primary-color);
            overflow: hidden;
            margin-bottom: 1rem;
            max-width: 350px;
            animation: slideInRight 0.3s ease;
        }
        
        .toast-header-custom {
            padding: 1rem;
            background: #f8f9fa;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .toast-body-custom {
            padding: 1rem;
        }
        
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        /* Close sidebar on mobile after click */
        .sidebar-close {
            display: none;
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--gray-color);
        }
        
        @media (max-width: 992px) {
            .sidebar-close {
                display: block;
            }
        }
        
        /* Live feed styles */
        .live-feed-container {
            max-height: 500px;
            overflow-y: auto;
        }
        
        .live-feed-item {
            padding: 1rem;
            border-bottom: 1px solid #eee;
            transition: var(--transition);
        }
        
        .live-feed-item:hover {
            background-color: #f8f9fa;
        }
        
        .live-feed-item.new {
            background-color: rgba(76, 201, 240, 0.1);
            animation: highlight 2s ease;
        }
        
        @keyframes highlight {
            0% { background-color: rgba(76, 201, 240, 0.3); }
            100% { background-color: rgba(76, 201, 240, 0.1); }
        }
        
        /* Location test panel */
        .location-test-panel {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: var(--border-radius);
            padding: 2rem;
            margin-bottom: 2rem;
        }
        
        .location-status {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
        }
        
        .location-status.valid {
            background: rgba(40, 167, 69, 0.1);
            border-left: 4px solid #28a745;
        }
        
        .location-status.invalid {
            background: rgba(220, 53, 69, 0.1);
            border-left: 4px solid #dc3545;
        }
        
        /* PWA banner */
        .pwa-banner {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, #4361ee 0%, #3f37c9 100%);
            color: white;
            padding: 1rem;
            display: none;
            z-index: 1000;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
        }
        
        .pwa-banner.show {
            display: flex;
            justify-content: space-between;
            align-items: center;
            animation: slideUp 0.3s ease;
        }
        
        @keyframes slideUp {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }
    </style>
</head>
<body>
    <!-- Loading Spinner -->
    <div id="loadingSpinner" class="spinner-container">
        <div class="spinner"></div>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- PWA Install Button -->
    <button id="pwaInstallBtn" class="btn btn-primary-custom pwa-install-btn" style="display: none;">
        <i class="fas fa-download me-2"></i> Install App
    </button>

    <!-- PWA Banner -->
    <div id="pwaBanner" class="pwa-banner">
        <div>
            <strong>Install GSAMS App</strong>
            <p class="mb-0 small">Get better experience with our PWA</p>
        </div>
        <div>
            <button class="btn btn-light btn-sm me-2" onclick="dismissPwaBanner()">Later</button>
            <button class="btn btn-primary-custom btn-sm" onclick="installPWA()">Install</button>
        </div>
    </div>

    <!-- Sidebar overlay for mobile -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="closeSidebar()"></div>

    <!-- Home Page -->
    <div id="homePage">
        <!-- Navbar -->
        <nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top">
            <div class="container">
                <a class="navbar-brand" href="#">
                    <i class="fas fa-map-marker-alt"></i> GSAMS
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item">
                            <a class="nav-link" href="#home">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#features">Features</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#how-it-works">How It Works</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#contact">Contact</a>
                        </li>
                        <li class="nav-item ms-2">
                            <button class="btn btn-outline-custom" onclick="showPage('login')">Login</button>
                        </li>
                        <li class="nav-item">
                            <button class="btn btn-primary-custom" onclick="showPage('register')">Get Started</button>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

        <!-- Hero Section -->
        <section class="hero-section" id="home">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-lg-6" data-aos="fade-right">
                        <h1 class="hero-title">GeoSecure Attendance Management System</h1>
                        <p class="hero-subtitle">
                            A comprehensive solution for secure, location-based attendance tracking using GPS, SMS, USSD, and QR codes. Perfect for events, meetings, and employee tracking.
                        </p>
                        <div class="hero-btns">
                            <button class="btn btn-primary-custom" onclick="showPage('register')">
                                <i class="fas fa-rocket me-2"></i> Start Free Trial
                            </button>
                            <button class="btn btn-outline-custom" style="border-color: white; color: white;" onclick="showPage('login')">
                                <i class="fas fa-sign-in-alt me-2"></i> Admin Login
                            </button>
                        </div>
                    </div>
                    <div class="col-lg-6" data-aos="fade-left">
                        <div class="text-center mt-5 mt-lg-0">
                            <img src="https://cdn.pixabay.com/photo/2017/08/06/00/18/people-2587399_1280.jpg" class="img-fluid rounded-3 shadow-lg" alt="Attendance Management" style="max-height: 400px;">
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Features Section -->
        <section class="py-5 my-5" id="features">
            <div class="container">
                <div class="text-center mb-5">
                    <h2 class="section-title text-center">Powerful Features</h2>
                    <p class="section-subtitle text-center">
                        GSAMS provides multiple verification methods to ensure accurate attendance tracking in any situation
                    </p>
                </div>
                <div class="row g-4">
                    <div class="col-md-6 col-lg-4" data-aos="fade-up" data-aos-delay="100">
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas fa-map-marker-alt"></i>
                            </div>
                            <h4 class="feature-title">GPS Location Verification</h4>
                            <p class="text-muted">
                                Verify attendance using smartphone GPS with radius-based validation. Get real-time location data with accuracy metrics.
                            </p>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-4" data-aos="fade-up" data-aos-delay="200">
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas fa-sms"></i>
                            </div>
                            <h4 class="feature-title">SMS Attendance</h4>
                            <p class="text-muted">
                                Allow attendance via SMS for basic phones. Simple format: "ATTEND [CODE] [NAME]" to register attendance.
                            </p>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-4" data-aos="fade-up" data-aos-delay="300">
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas fa-mobile-alt"></i>
                            </div>
                            <h4 class="feature-title">USSD Integration</h4>
                            <p class="text-muted">
                                Interactive USSD menus for attendance registration without internet access. Works on all mobile devices.
                            </p>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-4" data-aos="fade-up" data-aos-delay="400">
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas fa-qrcode"></i>
                            </div>
                            <h4 class="feature-title">QR Code Check-in</h4>
                            <p class="text-muted">
                                Generate unique QR codes for each meeting. Participants scan with their smartphones for instant check-in.
                            </p>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-4" data-aos="fade-up" data-aos-delay="500">
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas fa-user-check"></i>
                            </div>
                            <h4 class="feature-title">Manual & Kiosk Mode</h4>
                            <p class="text-muted">
                                Admin-assisted check-ins and kiosk stations for events. Perfect for conferences and large gatherings.
                            </p>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-4" data-aos="fade-up" data-aos-delay="600">
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas fa-chart-bar"></i>
                            </div>
                            <h4 class="feature-title">Advanced Analytics</h4>
                            <p class="text-muted">
                                Comprehensive reports, export to PDF/Excel, real-time dashboards, and audit logs for complete transparency.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- How It Works -->
        <section class="py-5 my-5 bg-light" id="how-it-works">
            <div class="container">
                <div class="text-center mb-5">
                    <h2 class="section-title text-center">How It Works</h2>
                    <p class="section-subtitle text-center">
                        Simple four-step process to manage attendance for any event or meeting
                    </p>
                </div>
                <div class="row g-4">
                    <div class="col-md-6 col-lg-3" data-aos="fade-up">
                        <div class="text-center p-4">
                            <div class="bg-primary text-white rounded-circle d-inline-flex align-items-center justify-content-center mb-4" style="width: 80px; height: 80px;">
                                <i class="fas fa-calendar-plus fa-2x"></i>
                            </div>
                            <h4>1. Create Meeting</h4>
                            <p class="text-muted">Set up meeting details, location, time window, and choose verification methods.</p>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-3" data-aos="fade-up" data-aos-delay="100">
                        <div class="text-center p-4">
                            <div class="bg-primary text-white rounded-circle d-inline-flex align-items-center justify-content-center mb-4" style="width: 80px; height: 80px;">
                                <i class="fas fa-broadcast-tower fa-2x"></i>
                            </div>
                            <h4>2. Share Access</h4>
                            <p class="text-muted">Share meeting codes via QR, SMS, or USSD with your attendees.</p>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-3" data-aos="fade-up" data-aos-delay="200">
                        <div class="text-center p-4">
                            <div class="bg-primary text-white rounded-circle d-inline-flex align-items-center justify-content-center mb-4" style="width: 80px; height: 80px;">
                                <i class="fas fa-user-check fa-2x"></i>
                            </div>
                            <h4>3. Attendance Collection</h4>
                            <p class="text-muted">Attendees check-in using their preferred method. All methods are validated.</p>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-3" data-aos="fade-up" data-aos-delay="300">
                        <div class="text-center p-4">
                            <div class="bg-primary text-white rounded-circle d-inline-flex align-items-center justify-content-center mb-4" style="width: 80px; height: 80px;">
                                <i class="fas fa-chart-pie fa-2x"></i>
                            </div>
                            <h4>4. Analytics & Reports</h4>
                            <p class="text-muted">View real-time attendance, generate reports, export data for analysis.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- CTA Section -->
        <section class="py-5 my-5">
            <div class="container">
                <div class="row justify-content-center">
                    <div class="col-lg-8 text-center" data-aos="zoom-in">
                        <h2 class="mb-4">Ready to Transform Your Attendance Management?</h2>
                        <p class="mb-4">Join thousands of organizations using GSAMS for secure, reliable attendance tracking.</p>
                        <button class="btn btn-primary-custom btn-lg" onclick="showPage('register')">
                            <i class="fas fa-rocket me-2"></i> Start Your Free Trial Today
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="footer" id="contact">
            <div class="container">
                <div class="row">
                    <div class="col-lg-4 mb-4 mb-lg-0">
                        <h3 class="footer-title">
                            <i class="fas fa-map-marker-alt"></i> GSAMS
                        </h3>
                        <p class="mb-4">GeoSecure Attendance Management System provides secure, location-based attendance tracking for organizations of all sizes.</p>
                        <div class="d-flex gap-3">
                            <a href="#" class="text-white"><i class="fab fa-facebook fa-lg"></i></a>
                            <a href="#" class="text-white"><i class="fab fa-twitter fa-lg"></i></a>
                            <a href="#" class="text-white"><i class="fab fa-linkedin fa-lg"></i></a>
                            <a href="#" class="text-white"><i class="fab fa-instagram fa-lg"></i></a>
                        </div>
                    </div>
                    <div class="col-lg-2 col-md-6 mb-4 mb-md-0">
                        <h4 class="footer-title">Quick Links</h4>
                        <ul class="footer-links">
                            <li><a href="#home">Home</a></li>
                            <li><a href="#features">Features</a></li>
                            <li><a href="#how-it-works">How It Works</a></li>
                            <li><a href="#" onclick="showPage('login')">Login</a></li>
                            <li><a href="#" onclick="showPage('register')">Register</a></li>
                        </ul>
                    </div>
                    <div class="col-lg-3 col-md-6 mb-4 mb-md-0">
                        <h4 class="footer-title">Features</h4>
                        <ul class="footer-links">
                            <li><a href="#">GPS Verification</a></li>
                            <li><a href="#">SMS Attendance</a></li>
                            <li><a href="#">USSD Integration</a></li>
                            <li><a href="#">QR Codes</a></li>
                            <li><a href="#">Analytics & Reports</a></li>
                        </ul>
                    </div>
                    <div class="col-lg-3 col-md-6">
                        <h4 class="footer-title">Contact Us</h4>
                        <ul class="footer-links">
                            <li><i class="fas fa-envelope me-2"></i> support@gsams.com</li>
                            <li><i class="fas fa-phone me-2"></i> +1 (555) 123-4567</li>
                            <li><i class="fas fa-map-marker-alt me-2"></i> 123 Business Ave, Suite 100<br>New York, NY 10001</li>
                        </ul>
                    </div>
                </div>
                <div class="copyright">
                    <p>&copy; 2023 GSAMS - GeoSecure Attendance Management System. All rights reserved.</p>
                </div>
            </div>
        </footer>
    </div>

    <!-- Register Page -->
    <div id="registerPage" class="auth-container" style="display: none;">
        <div class="auth-card">
            <div class="text-center mb-4">
                <h2 class="auth-title">Create Account</h2>
                <p class="auth-subtitle">Sign up for your GSAMS admin account</p>
            </div>
            
            <form id="registerForm">
                <div class="mb-3">
                    <label for="regOrganizationName" class="form-label">Organization Name</label>
                    <input type="text" class="form-control" id="regOrganizationName" required>
                </div>
                
                <div class="mb-3">
                    <label for="regFullName" class="form-label">Full Name</label>
                    <input type="text" class="form-control" id="regFullName" required>
                </div>
                
                <div class="mb-3">
                    <label for="regEmail" class="form-label">Email Address</label>
                    <input type="email" class="form-control" id="regEmail" required>
                </div>
                
                <div class="mb-3">
                    <label for="regPhone" class="form-label">Phone Number</label>
                    <input type="tel" class="form-control" id="regPhone">
                </div>
                
                <div class="mb-3">
                    <label for="regPassword" class="form-label">Password</label>
                    <input type="password" class="form-control" id="regPassword" required>
                </div>
                
                <div class="mb-4">
                    <label for="regConfirmPassword" class="form-label">Confirm Password</label>
                    <input type="password" class="form-control" id="regConfirmPassword" required>
                </div>
                
                <div class="d-grid gap-2 mb-3">
                    <button type="submit" class="btn btn-primary-custom">
                        <i class="fas fa-user-plus me-2"></i> Create Account
                    </button>
                </div>
                
                <div class="text-center">
                    <p class="mb-0">Already have an account? <a href="#" class="text-primary" onclick="showPage('login')">Login here</a></p>
                </div>
            </form>
        </div>
    </div>

    <!-- Login Page -->
    <div id="loginPage" class="auth-container" style="display: none;">
        <div class="auth-card">
            <div class="text-center mb-4">
                <h2 class="auth-title">Admin Login</h2>
                <p class="auth-subtitle">Sign in to your GSAMS dashboard</p>
            </div>
            
            <form id="loginForm">
                <div class="mb-3">
                    <label for="loginEmail" class="form-label">Email Address</label>
                    <input type="email" class="form-control" id="loginEmail" required>
                </div>
                
                <div class="mb-4">
                    <label for="loginPassword" class="form-label">Password</label>
                    <input type="password" class="form-control" id="loginPassword" required>
                </div>
                
                <div class="d-grid gap-2 mb-3">
                    <button type="submit" class="btn btn-primary-custom">
                        <i class="fas fa-sign-in-alt me-2"></i> Sign In
                    </button>
                </div>
                
                <div class="text-center">
                    <p class="mb-0">Don't have an account? <a href="#" class="text-primary" onclick="showPage('register')">Register here</a></p>
                </div>
            </form>
        </div>
    </div>

    <!-- Dashboard -->
    <div id="dashboard" style="display: none;">
        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">
                    <i class="fas fa-map-marker-alt me-2"></i> GSAMS
                </div>
                <button class="sidebar-close" onclick="closeSidebar()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="sidebar-menu">
                <a href="#" class="sidebar-item active" onclick="showDashboardSection('dashboard-home')">
                    <i class="fas fa-home"></i> Dashboard
                </a>
                <a href="#" class="sidebar-item" onclick="showDashboardSection('meetings')">
                    <i class="fas fa-calendar-alt"></i> Meetings
                </a>
                <a href="#" class="sidebar-item" onclick="showDashboardSection('attendance')">
                    <i class="fas fa-user-check"></i> Attendance
                </a>
                <a href="#" class="sidebar-item" onclick="showDashboardSection('reports')">
                    <i class="fas fa-chart-bar"></i> Reports
                </a>
                <a href="#" class="sidebar-item" onclick="showDashboardSection('admins')">
                    <i class="fas fa-users-cog"></i> Admins
                </a>
                <a href="#" class="sidebar-item" onclick="showDashboardSection('settings')">
                    <i class="fas fa-cog"></i> Settings
                </a>
                <a href="#" class="sidebar-item" onclick="showDashboardSection('audit-logs')">
                    <i class="fas fa-clipboard-list"></i> Audit Logs
                </a>
                <a href="#" class="sidebar-item" onclick="showDashboardSection('location-test')">
                    <i class="fas fa-map-marker-alt"></i> Location Test
                </a>
                <a href="#" class="sidebar-item" onclick="showDashboardSection('pwa-settings')">
                    <i class="fas fa-mobile-alt"></i> PWA Settings
                </a>
                
                <div class="mt-5 px-3">
                    <hr>
                    <a href="#" class="sidebar-item" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </a>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content" id="mainContent">
            <!-- Top Bar -->
            <div class="top-bar">
                <div class="d-flex align-items-center">
                    <button class="toggle-sidebar me-3" id="toggleSidebar">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h3 class="page-title" id="pageTitle">Dashboard</h3>
                </div>
                
                <div class="user-menu">
                    <div class="d-flex align-items-center">
                        <div class="user-avatar me-2" id="userAvatar">JD</div>
                        <div>
                            <h6 class="mb-0" id="userName">John Doe</h6>
                            <small class="text-muted" id="userRole">Super Admin</small>
                        </div>
                    </div>
                    <div class="dropdown">
                        <button class="btn btn-light btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown">
                            <i class="fas fa-ellipsis-v"></i>
                        </button>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="#"><i class="fas fa-user me-2"></i> Profile</a></li>
                            <li><a class="dropdown-item" href="#" onclick="showDashboardSection('settings')"><i class="fas fa-cog me-2"></i> Settings</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#" onclick="logout()"><i class="fas fa-sign-out-alt me-2"></i> Logout</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- Dashboard Content -->
            <div id="dashboard-content">
                <!-- Dashboard Home -->
                <div id="dashboard-home" class="dashboard-section">
                    <div class="row mb-4">
                        <div class="col-xl-3 col-md-6 mb-4">
                            <div class="stats-card">
                                <div class="stats-icon bg-primary text-white">
                                    <i class="fas fa-calendar-alt"></i>
                                </div>
                                <h3 class="stats-number" id="totalMeetings">0</h3>
                                <p class="stats-title">Total Meetings</p>
                            </div>
                        </div>
                        <div class="col-xl-3 col-md-6 mb-4">
                            <div class="stats-card">
                                <div class="stats-icon bg-success text-white">
                                    <i class="fas fa-user-check"></i>
                                </div>
                                <h3 class="stats-number" id="activeMeetings">0</h3>
                                <p class="stats-title">Active Meetings</p>
                            </div>
                        </div>
                        <div class="col-xl-3 col-md-6 mb-4">
                            <div class="stats-card">
                                <div class="stats-icon bg-warning text-white">
                                    <i class="fas fa-users"></i>
                                </div>
                                <h3 class="stats-number" id="totalAttendance">0</h3>
                                <p class="stats-title">Total Attendance</p>
                            </div>
                        </div>
                        <div class="col-xl-3 col-md-6 mb-4">
                            <div class="stats-card">
                                <div class="stats-icon bg-danger text-white">
                                    <i class="fas fa-user-clock"></i>
                                </div>
                                <h3 class="stats-number" id="todayAttendance">0</h3>
                                <p class="stats-title">Today's Attendance</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row mb-4">
                        <div class="col-lg-8">
                            <div class="table-container">
                                <div class="table-header">
                                    <h5 class="mb-0">Real-time Monitoring</h5>
                                    <span class="badge bg-danger live-badge">LIVE</span>
                                </div>
                                <div class="p-3">
                                    <div class="row text-center">
                                        <div class="col-md-4 mb-3">
                                            <div class="p-3 bg-light rounded">
                                                <h4 id="liveAttendees">0</h4>
                                                <small class="text-muted">Active Attendees</small>
                                            </div>
                                        </div>
                                        <div class="col-md-4 mb-3">
                                            <div class="p-3 bg-light rounded">
                                                <h4 id="liveMeetings">0</h4>
                                                <small class="text-muted">Active Meetings</small>
                                            </div>
                                        </div>
                                        <div class="col-md-4 mb-3">
                                            <div class="p-3 bg-light rounded">
                                                <h4 id="liveVerified">0</h4>
                                                <small class="text-muted">Verified Today</small>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="live-feed-container" id="liveFeed">
                                        <!-- Live attendance feed will be populated here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <div class="table-container">
                                <div class="table-header">
                                    <h5 class="mb-0">Attendance by Type</h5>
                                </div>
                                <div class="p-3">
                                    <canvas id="attendanceChart" height="250"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-lg-8 mb-4">
                            <div class="table-container">
                                <div class="table-header">
                                    <h5 class="mb-0">Recent Attendance</h5>
                                    <a href="#" class="btn btn-sm btn-outline-custom" onclick="showDashboardSection('attendance')">View All</a>
                                </div>
                                <div class="table-responsive">
                                    <table class="table table-hover mb-0">
                                        <thead>
                                            <tr>
                                                <th>Name</th>
                                                <th>Meeting</th>
                                                <th>Method</th>
                                                <th>Time</th>
                                                <th>Status</th>
                                                <th>Confidence</th>
                                            </tr>
                                        </thead>
                                        <tbody id="recentAttendance">
                                            <!-- Filled by JavaScript -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-lg-4 mb-4">
                            <div class="table-container">
                                <div class="table-header">
                                    <h5 class="mb-0">Quick Actions</h5>
                                </div>
                                <div class="p-3">
                                    <div class="d-grid gap-2">
                                        <button class="btn btn-primary-custom" onclick="showCreateMeetingModal()">
                                            <i class="fas fa-plus me-2"></i> Create Meeting
                                        </button>
                                        <button class="btn btn-outline-custom" onclick="showLocationTestModal()">
                                            <i class="fas fa-map-marker-alt me-2"></i> Test Location
                                        </button>
                                        <button class="btn btn-outline-custom" onclick="exportAllMeetings()">
                                            <i class="fas fa-download me-2"></i> Export All Data
                                        </button>
                                        <button class="btn btn-outline-custom" onclick="showDashboardSection('pwa-settings')">
                                            <i class="fas fa-mobile-alt me-2"></i> PWA Settings
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Meetings Section -->
                <div id="meetings" class="dashboard-section" style="display: none;">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4>Meetings Management</h4>
                        <button class="btn btn-primary-custom" onclick="showCreateMeetingModal()">
                            <i class="fas fa-plus me-2"></i> Create New Meeting
                        </button>
                    </div>
                    
                    <div class="row mb-4">
                        <div class="col-md-6 col-lg-3 mb-3">
                            <div class="form-group">
                                <label class="form-label">Status</label>
                                <select class="form-select" id="meetingStatusFilter">
                                    <option value="">All Status</option>
                                    <option value="draft">Draft</option>
                                    <option value="active">Active</option>
                                    <option value="in_progress">In Progress</option>
                                    <option value="completed">Completed</option>
                                    <option value="cancelled">Cancelled</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-3 mb-3">
                            <div class="form-group">
                                <label class="form-label">Start Date</label>
                                <input type="date" class="form-control" id="meetingStartDate">
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-3 mb-3">
                            <div class="form-group">
                                <label class="form-label">End Date</label>
                                <input type="date" class="form-control" id="meetingEndDate">
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-3 mb-3 d-flex align-items-end">
                            <button class="btn btn-primary-custom w-100" onclick="loadMeetings()">
                                <i class="fas fa-filter me-2"></i> Filter
                            </button>
                        </div>
                    </div>
                    
                    <div class="table-container">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Title</th>
                                        <th>Date & Time</th>
                                        <th>Location</th>
                                        <th>Attendance Methods</th>
                                        <th>Status</th>
                                        <th>Attendees</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="meetingsTable">
                                    <!-- Filled by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Attendance Section -->
                <div id="attendance" class="dashboard-section" style="display: none;">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4>Attendance Records</h4>
                        <div class="btn-group">
                            <button class="btn btn-outline-custom" onclick="exportAllAttendance()">
                                <i class="fas fa-download me-2"></i> Export All
                            </button>
                            <button class="btn btn-primary-custom" onclick="showRealTimeMonitoring()">
                                <i class="fas fa-eye me-2"></i> Live View
                            </button>
                        </div>
                    </div>
                    
                    <div class="row mb-4">
                        <div class="col-md-4 mb-3">
                            <div class="form-group">
                                <label class="form-label">Meeting</label>
                                <select class="form-select" id="attendanceMeetingFilter">
                                    <option value="">All Meetings</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-4 mb-3">
                            <div class="form-group">
                                <label class="form-label">Verification Type</label>
                                <select class="form-select" id="attendanceTypeFilter">
                                    <option value="">All Types</option>
                                    <option value="smartphone_gps">GPS</option>
                                    <option value="sms">SMS</option>
                                    <option value="ussd">USSD</option>
                                    <option value="kiosk">Kiosk</option>
                                    <option value="manual">Manual</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-4 mb-3">
                            <div class="form-group">
                                <label class="form-label">Status</label>
                                <select class="form-select" id="attendanceStatusFilter">
                                    <option value="">All Status</option>
                                    <option value="pending">Pending</option>
                                    <option value="verified">Verified</option>
                                    <option value="flagged">Flagged</option>
                                    <option value="rejected">Rejected</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="table-container">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Meeting</th>
                                        <th>Method</th>
                                        <th>Check-in Time</th>
                                        <th>Location</th>
                                        <th>Confidence</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="attendanceTable">
                                    <!-- Filled by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Reports Section -->
                <div id="reports" class="dashboard-section" style="display: none;">
                    <h4 class="mb-4">Reports & Analytics</h4>
                    
                    <div class="row mb-4">
                        <div class="col-md-8">
                            <div class="table-container">
                                <div class="table-header">
                                    <h5 class="mb-0">Analytics Dashboard</h5>
                                    <div class="btn-group">
                                        <button class="btn btn-sm btn-outline-custom" onclick="loadAnalytics('day')">Today</button>
                                        <button class="btn btn-sm btn-outline-custom" onclick="loadAnalytics('week')">Week</button>
                                        <button class="btn btn-sm btn-outline-custom" onclick="loadAnalytics('month')">Month</button>
                                        <button class="btn btn-sm btn-outline-custom" onclick="loadAnalytics('year')">Year</button>
                                    </div>
                                </div>
                                <div class="p-3">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <canvas id="trendChart" height="200"></canvas>
                                        </div>
                                        <div class="col-md-6">
                                            <canvas id="methodChart" height="200"></canvas>
                                        </div>
                                    </div>
                                    <div class="mt-4">
                                        <h6>Location Analytics</h6>
                                        <div id="locationAnalytics">
                                            <!-- Location analytics will be loaded here -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="table-container">
                                <div class="table-header">
                                    <h5 class="mb-0">Export Options</h5>
                                </div>
                                <div class="p-4">
                                    <div class="export-options">
                                        <div class="export-card" onclick="exportReport('pdf')">
                                            <i class="fas fa-file-pdf fa-3x text-danger mb-3"></i>
                                            <h5>Export to PDF</h5>
                                            <p class="text-muted small">Professional PDF reports with attendance details</p>
                                        </div>
                                        <div class="export-card" onclick="exportReport('excel')">
                                            <i class="fas fa-file-excel fa-3x text-success mb-3"></i>
                                            <h5>Export to Excel</h5>
                                            <p class="text-muted small">Detailed spreadsheets for analysis</p>
                                        </div>
                                        <div class="export-card" onclick="exportAllMeetingsReport()">
                                            <i class="fas fa-file-archive fa-3x text-warning mb-3"></i>
                                            <h5>All Meetings Report</h5>
                                            <p class="text-muted small">Complete organization report</p>
                                        </div>
                                        <div class="export-card" onclick="exportLocationAnalytics()">
                                            <i class="fas fa-map-marked-alt fa-3x text-primary mb-3"></i>
                                            <h5>Location Analytics</h5>
                                            <p class="text-muted small">GPS and location data analysis</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Admins Section -->
                <div id="admins" class="dashboard-section" style="display: none;">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4>Admin Management</h4>
                        <button class="btn btn-primary-custom" onclick="showCreateAdminModal()">
                            <i class="fas fa-user-plus me-2"></i> Add Admin
                        </button>
                    </div>
                    
                    <div class="table-container">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Email</th>
                                        <th>Phone</th>
                                        <th>Role</th>
                                        <th>Permissions</th>
                                        <th>Status</th>
                                        <th>Last Login</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="adminsTable">
                                    <!-- Filled by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Settings Section -->
                <div id="settings" class="dashboard-section" style="display: none;">
                    <h4 class="mb-4">Organization Settings</h4>
                    
                    <div class="row">
                        <div class="col-lg-8">
                            <div class="table-container">
                                <div class="table-header">
                                    <h5 class="mb-0">Attendance Settings</h5>
                                </div>
                                <div class="p-4">
                                    <form id="settingsForm">
                                        <div class="row mb-4">
                                            <div class="col-md-6">
                                                <label class="form-label">Default Location Radius (meters)</label>
                                                <input type="number" class="form-control" id="defaultRadius" value="100" min="10" max="1000">
                                            </div>
                                            <div class="col-md-6">
                                                <label class="form-label">Default Time Window (minutes)</label>
                                                <input type="number" class="form-control" id="defaultTimeWindow" value="30" min="5" max="120">
                                            </div>
                                        </div>
                                        
                                        <div class="mb-4">
                                            <label class="form-label fw-bold">Allowed Attendance Methods</label>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-check mb-2">
                                                        <input class="form-check-input" type="checkbox" id="allowGPS" checked>
                                                        <label class="form-check-label" for="allowGPS">
                                                            <i class="fas fa-map-marker-alt me-2"></i> Smartphone GPS
                                                        </label>
                                                    </div>
                                                    <div class="form-check mb-2">
                                                        <input class="form-check-input" type="checkbox" id="allowSMS" checked>
                                                        <label class="form-check-label" for="allowSMS">
                                                            <i class="fas fa-sms me-2"></i> SMS
                                                        </label>
                                                    </div>
                                                    <div class="form-check mb-2">
                                                        <input class="form-check-input" type="checkbox" id="allowUSSD" checked>
                                                        <label class="form-check-label" for="allowUSSD">
                                                            <i class="fas fa-mobile-alt me-2"></i> USSD
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-check mb-2">
                                                        <input class="form-check-input" type="checkbox" id="allowKiosk" checked>
                                                        <label class="form-check-label" for="allowKiosk">
                                                            <i class="fas fa-desktop me-2"></i> Kiosk
                                                        </label>
                                                    </div>
                                                    <div class="form-check mb-2">
                                                        <input class="form-check-input" type="checkbox" id="allowManual" checked>
                                                        <label class="form-check-label" for="allowManual">
                                                            <i class="fas fa-user-check me-2"></i> Manual
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="mb-4">
                                            <label class="form-label fw-bold">Verification Strictness</label>
                                            <select class="form-select" id="verificationStrictness">
                                                <option value="low">Low - Relaxed verification</option>
                                                <option value="medium" selected>Medium - Balanced verification</option>
                                                <option value="high">High - Strict verification</option>
                                            </select>
                                        </div>
                                        
                                        <div class="mb-4">
                                            <label class="form-label fw-bold">Duplicate Prevention</label>
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="preventSameDevice" checked>
                                                <label class="form-check-label" for="preventSameDevice">
                                                    Prevent same device check-ins
                                                </label>
                                            </div>
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="preventSamePhone" checked>
                                                <label class="form-check-label" for="preventSamePhone">
                                                    Prevent same phone number check-ins
                                                </label>
                                            </div>
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="preventSameNameTime" checked>
                                                <label class="form-check-label" for="preventSameNameTime">
                                                    Prevent same name within time window
                                                </label>
                                            </div>
                                        </div>
                                        
                                        <button type="submit" class="btn btn-primary-custom">
                                            <i class="fas fa-save me-2"></i> Save Settings
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-lg-4">
                            <div class="table-container mb-4">
                                <div class="table-header">
                                    <h5 class="mb-0">Organization Info</h5>
                                </div>
                                <div class="p-4">
                                    <div class="mb-3">
                                        <label class="form-label">Organization Name</label>
                                        <p class="fw-bold" id="orgName">GSAMS Organization</p>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Domain</label>
                                        <p class="fw-bold" id="orgDomain">example.com</p>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Created On</label>
                                        <p class="fw-bold" id="orgCreated">2023-01-01</p>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Status</label>
                                        <span class="badge bg-success" id="orgStatus">Active</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="table-container">
                                <div class="table-header">
                                    <h5 class="mb-0">API Information</h5>
                                </div>
                                <div class="p-4">
                                    <p class="small text-muted mb-3">Use these endpoints to integrate with your applications:</p>
                                    <div class="mb-3">
                                        <label class="form-label small">Base URL</label>
                                        <code class="d-block p-2 bg-light rounded" id="apiBaseUrl">https://gsb-hrs3.onrender.com/api</code>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label small">Your API Key</label>
                                        <code class="d-block p-2 bg-light rounded" id="apiKey">***************</code>
                                    </div>
                                    <button class="btn btn-sm btn-outline-custom w-100" onclick="regenerateApiKey()">
                                        <i class="fas fa-sync-alt me-2"></i> Regenerate API Key
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Audit Logs Section -->
                <div id="audit-logs" class="dashboard-section" style="display: none;">
                    <h4 class="mb-4">Audit Logs</h4>
                    
                    <div class="row mb-4">
                        <div class="col-md-3 mb-3">
                            <div class="form-group">
                                <label class="form-label">Start Date</label>
                                <input type="date" class="form-control" id="auditStartDate">
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="form-group">
                                <label class="form-label">End Date</label>
                                <input type="date" class="form-control" id="auditEndDate">
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="form-group">
                                <label class="form-label">Action</label>
                                <select class="form-select" id="auditActionFilter">
                                    <option value="">All Actions</option>
                                    <option value="USER_LOGIN">User Login</option>
                                    <option value="MEETING_CREATED">Meeting Created</option>
                                    <option value="ATTENDANCE_STATUS_UPDATED">Attendance Updated</option>
                                    <option value="EXPORT_PDF">PDF Export</option>
                                    <option value="EXPORT_EXCEL">Excel Export</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="form-group">
                                <label class="form-label">User</label>
                                <select class="form-select" id="auditUserFilter">
                                    <option value="">All Users</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="table-container">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Timestamp</th>
                                        <th>User</th>
                                        <th>Action</th>
                                        <th>Entity</th>
                                        <th>Details</th>
                                        <th>IP Address</th>
                                    </tr>
                                </thead>
                                <tbody id="auditLogsTable">
                                    <!-- Filled by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Location Test Section -->
                <div id="location-test" class="dashboard-section" style="display: none;">
                    <div class="location-test-panel">
                        <h4 class="mb-4">Location Testing & Verification</h4>
                        
                        <div class="row mb-4">
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label class="form-label">Meeting Code</label>
                                    <input type="text" class="form-control" id="testMeetingCode" placeholder="Enter meeting code">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label class="form-label">Or Select Meeting</label>
                                    <select class="form-select" id="testMeetingSelect">
                                        <option value="">Select a meeting</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label class="form-label">Latitude</label>
                                    <input type="number" step="any" class="form-control" id="testLatitude" placeholder="Enter latitude">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label class="form-label">Longitude</label>
                                    <input type="number" step="any" class="form-control" id="testLongitude" placeholder="Enter longitude">
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mb-4">
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    <label class="form-label">Accuracy (meters)</label>
                                    <input type="number" class="form-control" id="testAccuracy" value="10" min="1" max="1000">
                                </div>
                            </div>
                            <div class="col-md-6 d-flex align-items-end">
                                <button class="btn btn-primary-custom w-100" onclick="testLocation()">
                                    <i class="fas fa-map-marker-alt me-2"></i> Test Location
                                </button>
                            </div>
                        </div>
                        
                        <div id="locationTestResult" class="d-none">
                            <!-- Test results will be displayed here -->
                        </div>
                    </div>
                    
                    <div class="table-container">
                        <div class="table-header">
                            <h5 class="mb-0">Location Verification History</h5>
                        </div>
                        <div class="p-3">
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th>Meeting</th>
                                            <th>Test Time</th>
                                            <th>Coordinates</th>
                                            <th>Distance</th>
                                            <th>Accuracy</th>
                                            <th>Result</th>
                                            <th>Details</th>
                                        </tr>
                                    </thead>
                                    <tbody id="locationTestHistory">
                                        <!-- Filled by JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- PWA Settings Section -->
                <div id="pwa-settings" class="dashboard-section" style="display: none;">
                    <h4 class="mb-4">PWA & Mobile Settings</h4>
                    
                    <div class="row">
                        <div class="col-lg-8">
                            <div class="table-container mb-4">
                                <div class="table-header">
                                    <h5 class="mb-0">Progressive Web App Settings</h5>
                                </div>
                                <div class="p-4">
                                    <div class="mb-4">
                                        <div class="form-check form-switch mb-3">
                                            <input class="form-check-input" type="checkbox" id="enablePWA" checked>
                                            <label class="form-check-label" for="enablePWA">
                                                <strong>Enable PWA Features</strong>
                                            </label>
                                        </div>
                                        <p class="text-muted small">When enabled, users can install the app on their devices for better experience.</p>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label class="form-label">App Name</label>
                                        <input type="text" class="form-control" id="pwaAppName" value="GSAMS Attendance">
                                    </div>
                                    
                                    <div class="row mb-4">
                                        <div class="col-md-6">
                                            <label class="form-label">Theme Color</label>
                                            <input type="color" class="form-control form-control-color" id="pwaThemeColor" value="#2196F3">
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">Background Color</label>
                                            <input type="color" class="form-control form-control-color" id="pwaBackgroundColor" value="#ffffff">
                                        </div>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label class="form-label">Push Notifications</label>
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="checkbox" id="pwaPushNewAttendance" checked>
                                            <label class="form-check-label" for="pwaPushNewAttendance">
                                                Notify on new attendance
                                            </label>
                                        </div>
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="checkbox" id="pwaPushMeetingStart">
                                            <label class="form-check-label" for="pwaPushMeetingStart">
                                                Notify when meeting starts
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="pwaPushReminders">
                                            <label class="form-check-label" for="pwaPushReminders">
                                                Send attendance reminders
                                            </label>
                                        </div>
                                    </div>
                                    
                                    <button class="btn btn-primary-custom" onclick="savePwaSettings()">
                                        <i class="fas fa-save me-2"></i> Save PWA Settings
                                    </button>
                                </div>
                            </div>
                            
                            <div class="table-container">
                                <div class="table-header">
                                    <h5 class="mb-0">Device Registration</h5>
                                </div>
                                <div class="p-4">
                                    <p class="text-muted mb-3">Registered devices for push notifications:</p>
                                    <div id="registeredDevices">
                                        <!-- Registered devices will be listed here -->
                                    </div>
                                    <button class="btn btn-outline-custom w-100 mt-3" onclick="registerCurrentDevice()">
                                        <i class="fas fa-mobile-alt me-2"></i> Register This Device
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-lg-4">
                            <div class="table-container mb-4">
                                <div class="table-header">
                                    <h5 class="mb-0">PWA Preview</h5>
                                </div>
                                <div class="p-4 text-center">
                                    <div class="mb-4">
                                        <div class="bg-light rounded p-4 d-inline-block">
                                            <div class="mb-3">
                                                <div class="bg-primary rounded-circle d-inline-flex align-items-center justify-content-center" style="width: 60px; height: 60px;">
                                                    <i class="fas fa-map-marker-alt fa-2x text-white"></i>
                                                </div>
                                            </div>
                                            <h5 id="pwaPreviewName">GSAMS Attendance</h5>
                                            <p class="text-muted small">GeoSecure Attendance Management</p>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <h6>Installation Status</h6>
                                        <div id="pwaInstallStatus">
                                            <span class="badge bg-secondary">Checking...</span>
                                        </div>
                                    </div>
                                    
                                    <div class="d-grid gap-2">
                                        <button class="btn btn-primary-custom" onclick="installPWA()" id="installPwaBtn">
                                            <i class="fas fa-download me-2"></i> Install PWA
                                        </button>
                                        <button class="btn btn-outline-custom" onclick="testPushNotification()">
                                            <i class="fas fa-bell me-2"></i> Test Notification
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="table-container">
                                <div class="table-header">
                                    <h5 class="mb-0">Offline Capabilities</h5>
                                </div>
                                <div class="p-4">
                                    <div class="mb-3">
                                        <div class="d-flex justify-content-between mb-1">
                                            <span>Cache Storage</span>
                                            <span id="cacheSize">0 KB</span>
                                        </div>
                                        <div class="progress" style="height: 8px;">
                                            <div class="progress-bar" id="cacheProgress" style="width: 0%"></div>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="enableOffline" checked>
                                            <label class="form-check-label" for="enableOffline">
                                                Enable offline mode
                                            </label>
                                        </div>
                                        <p class="text-muted small mb-0">Store data locally for offline access</p>
                                    </div>
                                    
                                    <div class="d-grid gap-2">
                                        <button class="btn btn-outline-custom" onclick="clearCache()">
                                            <i class="fas fa-trash me-2"></i> Clear Cache
                                        </button>
                                        <button class="btn btn-outline-custom" onclick="updateCache()">
                                            <i class="fas fa-sync-alt me-2"></i> Update Cache
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    
    <!-- Create Meeting Modal -->
    <div class="modal fade" id="createMeetingModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content modal-custom">
                <div class="modal-header modal-header-custom">
                    <h5 class="modal-title">Create New Meeting</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <ul class="nav nav-tabs" id="meetingTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="details-tab" data-bs-toggle="tab" data-bs-target="#details" type="button" role="tab">Meeting Details</button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="form-tab" data-bs-toggle="tab" data-bs-target="#form" type="button" role="tab">Attendance Form</button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="sharing-tab" data-bs-toggle="tab" data-bs-target="#sharing" type="button" role="tab">Share & QR Code</button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="advanced-tab" data-bs-toggle="tab" data-bs-target="#advanced" type="button" role="tab">Advanced Settings</button>
                        </li>
                    </ul>
                    
                    <div class="tab-content mt-4" id="meetingTabsContent">
                        <!-- Tab 1: Meeting Details -->
                        <div class="tab-pane fade show active" id="details" role="tabpanel">
                            <form id="createMeetingForm">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Meeting Title *</label>
                                        <input type="text" class="form-control" id="meetingTitle" required>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Location Name *</label>
                                        <input type="text" class="form-control" id="meetingLocationName" required>
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Description</label>
                                    <textarea class="form-control" id="meetingDescription" rows="3"></textarea>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Start Date & Time *</label>
                                        <input type="datetime-local" class="form-control" id="meetingStartTime" required>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">End Date & Time *</label>
                                        <input type="datetime-local" class="form-control" id="meetingEndTime" required>
                                    </div>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Latitude *</label>
                                        <input type="number" step="any" class="form-control" id="meetingLatitude" required>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Longitude *</label>
                                        <input type="number" step="any" class="form-control" id="meetingLongitude" required>
                                    </div>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Location Radius (meters)</label>
                                        <input type="number" class="form-control" id="meetingRadius" value="100" min="10" max="1000">
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Location Address</label>
                                        <input type="text" class="form-control" id="meetingAddress" placeholder="Street address, city, country">
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Attendance Methods</label>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="allowGPSMeeting" checked>
                                                <label class="form-check-label" for="allowGPSMeeting">
                                                    <i class="fas fa-map-marker-alt me-2"></i> Smartphone GPS
                                                </label>
                                            </div>
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="allowSMSMeeting" checked>
                                                <label class="form-check-label" for="allowSMSMeeting">
                                                    <i class="fas fa-sms me-2"></i> SMS
                                                </label>
                                            </div>
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="allowUSSDMeeting" checked>
                                                <label class="form-check-label" for="allowUSSDMeeting">
                                                    <i class="fas fa-mobile-alt me-2"></i> USSD
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="allowKioskMeeting" checked>
                                                <label class="form-check-label" for="allowKioskMeeting">
                                                    <i class="fas fa-desktop me-2"></i> Kiosk
                                                </label>
                                            </div>
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="allowManualMeeting" checked>
                                                <label class="form-check-label" for="allowManualMeeting">
                                                    <i class="fas fa-user-check me-2"></i> Manual
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                        
                        <!-- Tab 2: Form Builder -->
                        <div class="tab-pane fade" id="form" role="tabpanel">
                            <div class="form-builder-container">
                                <div class="form-check mb-4">
                                    <input class="form-check-input" type="checkbox" id="requireForm">
                                    <label class="form-check-label" for="requireForm">
                                        <strong>Require attendees to fill this form</strong> (Meeting cannot be created without at least one field)
                                    </label>
                                </div>
                                
                                <h5 class="mb-4">Custom Attendance Form Builder</h5>
                                <p class="text-muted mb-4">Add custom fields that attendees will fill when joining the meeting.</p>
                                
                                <div class="row">
                                    <div class="col-md-8">
                                        <div class="mb-4">
                                            <h6>Form Fields</h6>
                                            <div id="formFieldsList">
                                                <div class="alert alert-info">
                                                    No fields added yet. Click "Add Field" to create your first form field.
                                                </div>
                                            </div>
                                            
                                            <div class="mt-4">
                                                <button class="btn btn-outline-custom" onclick="addFormField()">
                                                    <i class="fas fa-plus me-2"></i> Add Field
                                                </button>
                                                <button class="btn btn-outline-secondary" onclick="addDefaultFields()">
                                                    <i class="fas fa-magic me-2"></i> Add Default Fields
                                                </button>
                                                <button class="btn btn-outline-secondary" onclick="clearFormFields()">
                                                    <i class="fas fa-trash me-2"></i> Clear All
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-4">
                                        <div class="preview-form">
                                            <h6>Form Preview</h6>
                                            <div id="formPreview">
                                                <p class="text-muted small">Form preview will appear here</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Tab 3: Sharing & QR Code -->
                        <div class="tab-pane fade" id="sharing" role="tabpanel">
                            <div class="share-section">
                                <h5 class="mb-4">Share Meeting</h5>
                                
                                <div class="row">
                                    <div class="col-md-6 mb-4">
                                        <div class="share-link-container">
                                            <h6><i class="fas fa-link me-2"></i> Meeting Link</h6>
                                            <p class="text-muted small mb-3">Share this link with attendees to join the meeting:</p>
                                            <div class="share-link" id="generatedLink">
                                                <span class="text-muted">Link will be generated after meeting creation</span>
                                            </div>
                                            <div class="mt-3 d-flex gap-2">
                                                <button class="btn btn-sm btn-primary-custom" onclick="copyMeetingLink()" id="copyLinkBtn" disabled>
                                                    <i class="fas fa-copy me-1"></i> Copy Link
                                                </button>
                                                <button class="btn btn-sm btn-outline-custom" onclick="testMeetingLink()" id="testLinkBtn" disabled>
                                                    <i class="fas fa-external-link-alt me-1"></i> Test Link
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-6 mb-4">
                                        <div class="qr-code-container">
                                            <h6><i class="fas fa-qrcode me-2"></i> QR Code</h6>
                                            <p class="text-muted small mb-3">Scan this code to join the meeting:</p>
                                            <div id="qrCodeCanvas"></div>
                                            <div class="mt-3">
                                                <button class="btn btn-sm btn-primary-custom" onclick="downloadQRCode()" id="downloadQRBtn" disabled>
                                                    <i class="fas fa-download me-1"></i> Download QR Code
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="mt-4">
                                    <h6><i class="fas fa-share-alt me-2"></i> Share via</h6>
                                    <div class="d-flex gap-2 mt-3">
                                        <button class="btn btn-sm btn-outline-primary" onclick="shareViaEmail()" id="shareEmailBtn" disabled>
                                            <i class="fas fa-envelope me-1"></i> Email
                                        </button>
                                        <button class="btn btn-sm btn-outline-info" onclick="shareViaWhatsApp()" id="shareWhatsAppBtn" disabled>
                                            <i class="fab fa-whatsapp me-1"></i> WhatsApp
                                        </button>
                                        <button class="btn btn-sm btn-outline-secondary" onclick="shareViaSMS()" id="shareSMSBtn" disabled>
                                            <i class="fas fa-sms me-1"></i> SMS
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Tab 4: Advanced Settings -->
                        <div class="tab-pane fade" id="advanced" role="tabpanel">
                            <div class="form-builder-container">
                                <h5 class="mb-4">Advanced Meeting Settings</h5>
                                
                                <div class="row mb-4">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label">Verification Strictness</label>
                                            <select class="form-select" id="meetingVerificationStrictness">
                                                <option value="low">Low - Relaxed verification</option>
                                                <option value="medium" selected>Medium - Balanced verification</option>
                                                <option value="high">High - Strict verification</option>
                                            </select>
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label class="form-label">Time Verification</label>
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="requireMinimumStay">
                                                <label class="form-check-label" for="requireMinimumStay">
                                                    Require minimum stay time
                                                </label>
                                            </div>
                                            <div class="input-group mb-3" id="minimumStayContainer" style="display: none;">
                                                <input type="number" class="form-control" id="minimumStayMinutes" value="5" min="1" max="120">
                                                <span class="input-group-text">minutes</span>
                                            </div>
                                            
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="enableContinuousMonitoring">
                                                <label class="form-check-label" for="enableContinuousMonitoring">
                                                    Enable continuous monitoring
                                                </label>
                                            </div>
                                            
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="autoVerifyAfterStay">
                                                <label class="form-check-label" for="autoVerifyAfterStay">
                                                    Auto-verify after minimum stay
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label">Duplicate Prevention</label>
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="preventSameDeviceMeeting" checked>
                                                <label class="form-check-label" for="preventSameDeviceMeeting">
                                                    Prevent same device
                                                </label>
                                            </div>
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="preventSamePhoneMeeting" checked>
                                                <label class="form-check-label" for="preventSamePhoneMeeting">
                                                    Prevent same phone
                                                </label>
                                            </div>
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="preventSameNameTimeMeeting" checked>
                                                <label class="form-check-label" for="preventSameNameTimeMeeting">
                                                    Prevent same name
                                                </label>
                                            </div>
                                            <div class="input-group mb-3">
                                                <input type="number" class="form-control" id="duplicateWindowMinutes" value="5" min="1" max="60">
                                                <span class="input-group-text">minutes window</span>
                                            </div>
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label class="form-label">PWA Settings</label>
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="enableMeetingPWA" checked>
                                                <label class="form-check-label" for="enableMeetingPWA">
                                                    Enable PWA for this meeting
                                                </label>
                                            </div>
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="checkbox" id="enablePushNotifications">
                                                <label class="form-check-label" for="enablePushNotifications">
                                                    Enable push notifications
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="alert alert-info">
                                    <i class="fas fa-info-circle me-2"></i>
                                    These settings will override the organization defaults for this specific meeting.
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="d-flex justify-content-between mt-4">
                        <div>
                            <button class="btn btn-outline-secondary" onclick="prevTab()">
                                <i class="fas fa-arrow-left me-2"></i> Previous
                            </button>
                            <button class="btn btn-outline-secondary ms-2" onclick="nextTab()">
                                Next <i class="fas fa-arrow-right ms-2"></i>
                            </button>
                        </div>
                        <div>
                            <button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal">Cancel</button>
                            <button type="button" class="btn btn-primary-custom" onclick="createMeeting()">Create Meeting</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Meeting Details Modal -->
    <div class="modal fade" id="meetingDetailsModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content modal-custom">
                <div class="modal-header modal-header-custom">
                    <h5 class="modal-title">Meeting Details</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="meetingDetailsContent">
                        <!-- Filled by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Create Admin Modal -->
    <div class="modal fade" id="createAdminModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content modal-custom">
                <div class="modal-header modal-header-custom">
                    <h5 class="modal-title">Add New Admin</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="createAdminForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Full Name</label>
                                <input type="text" class="form-control" id="adminFullName" required>
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Email Address</label>
                                <input type="email" class="form-control" id="adminEmail" required>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Phone Number</label>
                                <input type="tel" class="form-control" id="adminPhone">
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Password</label>
                                <input type="password" class="form-control" id="adminPassword" required>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Role</label>
                                <select class="form-select" id="adminRole" required>
                                    <option value="admin">Admin</option>
                                    <option value="viewer">Viewer</option>
                                </select>
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Status</label>
                                <select class="form-select" id="adminStatus" required>
                                    <option value="active" selected>Active</option>
                                    <option value="inactive">Inactive</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            <label class="form-label fw-bold">Permissions</label>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input class="form-check-input" type="checkbox" id="adminCanCreateMeetings" checked>
                                        <label class="form-check-label" for="adminCanCreateMeetings">
                                            Can create meetings
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input class="form-check-input" type="checkbox" id="adminCanEditMeetings" checked>
                                        <label class="form-check-label" for="adminCanEditMeetings">
                                            Can edit meetings
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input class="form-check-input" type="checkbox" id="adminCanViewReports" checked>
                                        <label class="form-check-label" for="adminCanViewReports">
                                            Can view reports
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check mb-2">
                                        <input class="form-check-input" type="checkbox" id="adminCanDeleteMeetings">
                                        <label class="form-check-label" for="adminCanDeleteMeetings">
                                            Can delete meetings
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input class="form-check-input" type="checkbox" id="adminCanManageAdmins">
                                        <label class="form-check-label" for="adminCanManageAdmins">
                                            Can manage admins
                                        </label>
                                    </div>
                                    <div class="form-check mb-2">
                                        <input class="form-check-input" type="checkbox" id="adminCanApproveAttendance" checked>
                                        <label class="form-check-label" for="adminCanApproveAttendance">
                                            Can approve attendance
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="d-flex justify-content-end">
                            <button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal">Cancel</button>
                            <button type="submit" class="btn btn-primary-custom">Add Admin</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
<div class="modal fade" id="successModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content modal-custom">
            <div class="modal-header modal-header-custom">
                <h5 class="modal-title">Meeting Created Successfully! </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="text-center mb-4">
                    <i class="fas fa-check-circle fa-4x text-success mb-3"></i>
                    <h4>Your meeting is now active!</h4>
                    <p class="text-muted" id="successMeetingTitle"></p>
                </div>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="share-link-container">
                            <h6><i class="fas fa-link me-2"></i> Meeting Link</h6>
                            <p class="text-muted small mb-3">Share this link with attendees:</p>
                            <div class="share-link" id="successMeetingLink">
                                <span class="text-muted">Loading...</span>
                            </div>
                            <div class="mt-3">
                                <button class="btn btn-sm btn-primary-custom w-100" onclick="copySuccessLink()">
                                    <i class="fas fa-copy me-1"></i> Copy Link
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="qr-code-container">
                            <h6><i class="fas fa-qrcode me-2"></i> QR Code</h6>
                            <p class="text-muted small mb-3">Scan to join meeting:</p>
                            <div id="successQRCode"></div>
                            <div class="mt-3">
                                <button class="btn btn-sm btn-primary-custom w-100" onclick="downloadSuccessQRCode()">
                                    <i class="fas fa-download me-1"></i> Download QR Code
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-4">
                    <h6><i class="fas fa-share-alt me-2"></i> Share via</h6>
                    <div class="d-flex gap-2 mt-3 flex-wrap">
                        <button class="btn btn-sm btn-outline-primary" onclick="shareSuccessViaEmail()">
                            <i class="fas fa-envelope me-1"></i> Email
                        </button>
                        <button class="btn btn-sm btn-outline-success" onclick="shareSuccessViaWhatsApp()">
                            <i class="fab fa-whatsapp me-1"></i> WhatsApp
                        </button>
                        <button class="btn btn-sm btn-outline-info" onclick="shareSuccessViaSMS()">
                            <i class="fas fa-sms me-1"></i> SMS
                        </button>
                        <button class="btn btn-sm btn-outline-secondary" onclick="shareSuccessViaCopy()">
                            <i class="fas fa-copy me-1"></i> Copy All
                        </button>
                    </div>
                </div>
                
                <div class="mt-4">
                    <h6><i class="fas fa-key me-2"></i> Access Codes</h6>
                    <div class="row mt-2">
                        <div class="col-md-4">
                            <div class="bg-light p-2 rounded text-center">
                                <small class="text-muted d-block">SMS Code</small>
                                <code class="fw-bold" id="successSmsCode">----</code>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="bg-light p-2 rounded text-center">
                                <small class="text-muted d-block">USSD Code</small>
                                <code class="fw-bold" id="successUssdCode">----</code>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="bg-light p-2 rounded text-center">
                                <small class="text-muted d-block">Public Code</small>
                                <code class="fw-bold" id="successPublicCode">----</code>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-4 alert alert-info">
                    <i class="fas fa-info-circle me-2"></i>
                    <strong>Next Steps:</strong> Share the link/QR code with attendees. Monitor attendance in real-time from your dashboard.
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary-custom" onclick="goToMeetingDashboard()">
                    <i class="fas fa-chart-bar me-2"></i> Go to Dashboard
                </button>
            </div>
        </div>
    </div>
</div>
    
    <!-- Location Test Modal -->
    <div class="modal fade" id="locationTestModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content modal-custom">
                <div class="modal-header modal-header-custom">
                    <h5 class="modal-title">Test Location Verification</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="locationTestModalContent">
                        <!-- Content will be filled dynamically -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Real-time Monitoring Modal -->
    <div class="modal fade" id="realTimeMonitoringModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content modal-custom">
                <div class="modal-header modal-header-custom">
                    <h5 class="modal-title">Real-time Monitoring</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="monitoring-panel">
                        <div class="row text-center">
                            <div class="col-md-3">
                                <h3 id="monitoringActiveAttendees">0</h3>
                                <small>Active Attendees</small>
                            </div>
                            <div class="col-md-3">
                                <h3 id="monitoringTotalAttendees">0</h3>
                                <small>Total Attendees</small>
                            </div>
                            <div class="col-md-3">
                                <h3 id="monitoringVerified">0</h3>
                                <small>Verified</small>
                            </div>
                            <div class="col-md-3">
                                <h3 id="monitoringPending">0</h3>
                                <small>Pending</small>
                            </div>
                        </div>
                    </div>
                    
                    <div class="table-container mt-4">
                        <div class="table-header">
                            <h5 class="mb-0">Live Attendance Feed</h5>
                            <span class="badge bg-danger live-badge">LIVE</span>
                        </div>
                        <div class="p-3">
                            <div class="live-feed-container" id="modalLiveFeed">
                                <!-- Live feed will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- AOS Animation Library -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    
    <!-- Main JavaScript -->
    <script>
        // Replace the existing JavaScript with this enhanced version

// Global variables
let currentUser = null;
let authToken = null;
let currentOrganization = null;
let attendanceChart = null;
let trendChart = null;
let methodChart = null;
let currentMeetingFormFields = [];
let generatedMeetingLink = '';
let generatedQRCode = '';
let currentMeetingCode = '';
let liveFeedInterval = null;
let deferredPrompt = null;
let serviceWorkerRegistration = null;
let successMeetingData = null;
let currentMeetingId = null;

// API Base URL
const API_BASE_URL = 'https://gsb-hrs3.onrender.com/api';
const FRONTEND_URL = window.location.origin || 'https://gsf-inky.vercel.app';

// Initialize the application
document.addEventListener('DOMContentLoaded', function() {
    // Hide loading spinner
    setTimeout(() => {
        document.getElementById('loadingSpinner').style.display = 'none';
    }, 1000);
    
    // Check if user is already logged in
    checkAuthStatus();
    
    // Setup form submissions
    setupForms();
    
    // Setup navbar scroll effect
    setupNavbarScroll();
    
    // Setup sidebar toggle
    document.getElementById('toggleSidebar').addEventListener('click', toggleSidebar);
    
    // Initialize form builder
    initializeFormBuilder();
    
    // Close sidebar when clicking overlay
    document.getElementById('sidebarOverlay').addEventListener('click', closeSidebar);
    
    // Setup PWA
    setupPWA();
    
    // Setup real-time updates
    setupRealTimeUpdates();
    
    // Setup meeting creation validation
    setupCreateMeetingValidation();
    
    // Check for updates
    checkForUpdates();
});

// Enhanced meeting validation and creation
function validateMeetingCreation() {
    // Check all required sections
    const sectionsComplete = validateAllMeetingSections();
    
    if (!sectionsComplete.allComplete) {
        showToast('Please complete all required sections', 'error');
        
        // Highlight incomplete sections
        sectionsComplete.incompleteSections.forEach(section => {
            const tab = document.querySelector(`[data-bs-target="#${section}"]`);
            if (tab) {
                tab.classList.add('text-danger', 'fw-bold');
            }
        });
        
        return false;
    }
    
    return true;
}

function validateAllMeetingSections() {
    const sections = {
        meetingDetails: validateMeetingDetailsSection(),
        attendanceForm: validateAttendanceFormSection(),
        advancedSettings: validateAdvancedSettingsSection()
    };
    
    const incompleteSections = Object.keys(sections).filter(key => !sections[key]);
    
    return {
        allComplete: incompleteSections.length === 0,
        incompleteSections,
        sections
    };
}

function validateMeetingDetailsSection() {
    const title = document.getElementById('meetingTitle')?.value.trim();
    const locationName = document.getElementById('meetingLocationName')?.value.trim();
    const startTime = document.getElementById('meetingStartTime')?.value;
    const endTime = document.getElementById('meetingEndTime')?.value;
    const latitude = document.getElementById('meetingLatitude')?.value;
    const longitude = document.getElementById('meetingLongitude')?.value;
    
    return !!(title && locationName && startTime && endTime && latitude && longitude);
}

function validateAttendanceFormSection() {
    const requireForm = document.getElementById('requireForm')?.checked || false;
    const formFields = currentMeetingFormFields;
    
    if (requireForm) {
        return formFields.length > 0;
    }
    return true;
}

function validateAdvancedSettingsSection() {
    const gpsEnabled = document.getElementById('allowGPSMeeting')?.checked || false;
    const smsEnabled = document.getElementById('allowSMSMeeting')?.checked || false;
    const ussdEnabled = document.getElementById('allowUSSDMeeting')?.checked || false;
    const kioskEnabled = document.getElementById('allowKioskMeeting')?.checked || false;
    const manualEnabled = document.getElementById('allowManualMeeting')?.checked || false;
    
    return gpsEnabled || smsEnabled || ussdEnabled || kioskEnabled || manualEnabled;
}

// Enhanced meeting creation
async function createMeeting() {
    try {
        // Validate complete meeting creation form
        if (!validateMeetingCreation()) {
            return;
        }
        
        // Show loading
        showLoading();
        
        // Prepare meeting data
        const meetingData = {
            title: document.getElementById('meetingTitle').value,
            description: document.getElementById('meetingDescription').value,
            location: {
                name: document.getElementById('meetingLocationName').value,
                latitude: parseFloat(document.getElementById('meetingLatitude').value),
                longitude: parseFloat(document.getElementById('meetingLongitude').value),
                radius: parseInt(document.getElementById('meetingRadius').value) || 100,
                address: document.getElementById('meetingAddress').value || ''
            },
            schedule: {
                startTime: document.getElementById('meetingStartTime').value,
                endTime: document.getElementById('meetingEndTime').value
            },
            attendanceConfig: {
                allowedModes: {
                    smartphoneGPS: document.getElementById('allowGPSMeeting').checked,
                    sms: document.getElementById('allowSMSMeeting').checked,
                    ussd: document.getElementById('allowUSSDMeeting').checked,
                    kiosk: document.getElementById('allowKioskMeeting').checked,
                    manual: document.getElementById('allowManualMeeting').checked
                },
                verificationStrictness: document.getElementById('meetingVerificationStrictness').value,
                duplicatePrevention: {
                    preventSameDevice: document.getElementById('preventSameDeviceMeeting').checked,
                    preventSamePhone: document.getElementById('preventSamePhoneMeeting').checked,
                    preventSameNameTime: document.getElementById('preventSameNameTimeMeeting').checked,
                    timeWindowMinutes: parseInt(document.getElementById('duplicateWindowMinutes').value) || 5
                }
            },
            customFormFields: currentMeetingFormFields,
            timeVerification: {
                requireMinimumStay: document.getElementById('requireMinimumStay').checked,
                minimumStayMinutes: parseInt(document.getElementById('minimumStayMinutes').value) || 5,
                enableContinuousMonitoring: document.getElementById('enableContinuousMonitoring').checked,
                autoVerifyAfterStay: document.getElementById('autoVerifyAfterStay').checked
            }
        };
        
        const response = await fetch(`${API_BASE_URL}/meetings`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${authToken}`
            },
            body: JSON.stringify(meetingData)
        });
        
        if (response.ok) {
            const meeting = await response.json();
            showToast('Meeting created successfully!', 'success');
            
            // Store meeting ID for later use
            currentMeetingId = meeting._id;
            
            // Generate and display meeting details
            await displayMeetingSuccess(meeting);
            
            // Close create meeting modal
            const createModal = bootstrap.Modal.getInstance(document.getElementById('createMeetingModal'));
            if (createModal) createModal.hide();
            
            // Reload meetings list
            loadMeetings();
            loadDashboardData();
            
        } else {
            const error = await response.json();
            showToast(error.error || 'Failed to create meeting', 'error');
            
            // Show validation errors if any
            if (error.validationStatus) {
                showValidationErrors(error.validationStatus);
            }
        }
    } catch (error) {
        console.error('Create meeting error:', error);
        showToast('Failed to create meeting. Please try again.', 'error');
    } finally {
        hideLoading();
    }
}

// Display meeting success modal with all details
async function displayMeetingSuccess(meeting) {
    try {
        // Get full meeting details
        const response = await fetch(`${API_BASE_URL}/meetings/${meeting._id}/full`, {
            headers: {
                'Authorization': `Bearer ${authToken}`
            }
        });
        
        if (!response.ok) throw new Error('Failed to fetch meeting details');
        
        const meetingDetails = await response.json();
        
        // Store success data
        successMeetingData = {
            meetingId: meetingDetails._id,
            title: meetingDetails.title,
            shareLinks: meetingDetails.links || generateMeetingLinks(meetingDetails._id, meetingDetails.accessCodes.publicCode),
            qrCode: meetingDetails.qrCode,
            accessCodes: meetingDetails.accessCodes
        };
        
        // Update success modal content
        document.getElementById('successMeetingTitle').textContent = meetingDetails.title;
        
        // Update meeting link
        const meetingLink = successMeetingData.shareLinks.attendeeForm;
        document.getElementById('successMeetingLink').innerHTML = `
            <a href="${meetingLink}" target="_blank">${meetingLink}</a>
        `;
        
        // Update QR code
        const qrContainer = document.getElementById('successQRCode');
        qrContainer.innerHTML = '';
        
        if (meetingDetails.qrCode) {
            qrContainer.innerHTML = `<img src="${meetingDetails.qrCode}" alt="QR Code" class="img-fluid rounded">`;
        } else {
            // Generate QR code
            QRCode.toCanvas(meetingLink, { width: 200, margin: 2 }, function(error, canvas) {
                if (!error) {
                    canvas.className = 'img-fluid rounded';
                    qrContainer.appendChild(canvas);
                    successMeetingData.generatedQRCode = canvas.toDataURL('image/png');
                } else {
                    qrContainer.innerHTML = '<p class="text-danger">Failed to generate QR code</p>';
                }
            });
        }
        
        // Update access codes
        document.getElementById('successSmsCode').textContent = meetingDetails.accessCodes.smsCode || 'N/A';
        document.getElementById('successUssdCode').textContent = meetingDetails.accessCodes.ussdCode || 'N/A';
        document.getElementById('successPublicCode').textContent = meetingDetails.accessCodes.publicCode || 'N/A';
        
        // Store the meeting link for sharing
        successMeetingData.meetingLink = meetingLink;
        
        // Show success modal
        const successModal = new bootstrap.Modal(document.getElementById('successModal'));
        successModal.show();
        
    } catch (error) {
        console.error('Display meeting success error:', error);
        showToast('Meeting created but failed to load details', 'warning');
        
        // Fallback: Show basic success message
        showToast('Meeting created successfully!', 'success');
    }
}

// Enhanced view meeting function
async function viewMeeting(meetingId) {
    try {
        showLoading();
        
        const response = await fetch(`${API_BASE_URL}/meetings/${meetingId}/full`, {
            headers: {
                'Authorization': `Bearer ${authToken}`
            }
        });
        
        if (response.ok) {
            const meeting = await response.json();
            showMeetingDetailsModal(meeting);
        } else {
            const error = await response.json();
            showToast(error.error || 'Failed to load meeting details', 'error');
        }
    } catch (error) {
        console.error('View meeting error:', error);
        showToast('Failed to load meeting details', 'error');
    } finally {
        hideLoading();
    }
}

// Enhanced meeting details modal
function showMeetingDetailsModal(meeting) {
    const startTime = new Date(meeting.schedule.startTime);
    const endTime = new Date(meeting.schedule.endTime);
    
    // Generate methods badges
    const methods = [];
    if (meeting.attendanceConfig?.allowedModes?.smartphoneGPS) methods.push('GPS');
    if (meeting.attendanceConfig?.allowedModes?.sms) methods.push('SMS');
    if (meeting.attendanceConfig?.allowedModes?.ussd) methods.push('USSD');
    if (meeting.attendanceConfig?.allowedModes?.kiosk) methods.push('Kiosk');
    if (meeting.attendanceConfig?.allowedModes?.manual) methods.push('Manual');
    
    // Generate status badge
    const statusBadge = getMeetingStatusBadge(meeting.status);
    
    // Generate attendance count (fetch from API or use provided)
    const attendanceCount = meeting.attendanceCount || 0;
    
    // Generate QR code if not provided
    let qrCodeHTML = '<p class="text-muted">Loading QR code...</p>';
    if (meeting.qrCode) {
        qrCodeHTML = `<img src="${meeting.qrCode}" alt="QR Code" class="img-fluid rounded">`;
    } else if (meeting.accessCodes?.publicCode) {
        const meetingLink = `${FRONTEND_URL}/attend/${meeting.accessCodes.publicCode}`;
        QRCode.toDataURL(meetingLink, { width: 150, margin: 1 }, function(error, url) {
            if (!error) {
                const qrElement = document.querySelector('#meetingDetailsModal #meetingQRCode');
                if (qrElement) {
                    qrElement.innerHTML = `<img src="${url}" alt="QR Code" class="img-fluid rounded">`;
                }
            }
        });
    }
    
    // Build meeting details content
    let content = `
        <div class="row">
            <div class="col-md-8">
                <div class="d-flex justify-content-between align-items-start mb-4">
                    <div>
                        <h4>${meeting.title}</h4>
                        <p class="text-muted mb-2">${meeting.description || 'No description'}</p>
                        <div class="d-flex align-items-center gap-2">
                            ${statusBadge}
                            <span class="badge bg-info">${attendanceCount} attendees</span>
                        </div>
                    </div>
                    <div class="btn-group">
                        <button class="btn btn-sm btn-outline-warning" onclick="editMeeting('${meeting._id}')">
                            <i class="fas fa-edit me-1"></i> Edit
                        </button>
                        <button class="btn btn-sm btn-outline-danger" onclick="deleteMeeting('${meeting._id}')">
                            <i class="fas fa-trash me-1"></i> Delete
                        </button>
                    </div>
                </div>
                
                <div class="row mb-4">
                    <div class="col-md-6">
                        <h6><i class="fas fa-calendar me-2"></i> Schedule</h6>
                        <p><strong>Start:</strong> ${startTime.toLocaleDateString()} ${startTime.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</p>
                        <p><strong>End:</strong> ${endTime.toLocaleDateString()} ${endTime.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</p>
                    </div>
                    <div class="col-md-6">
                        <h6><i class="fas fa-map-marker-alt me-2"></i> Location</h6>
                        <p><strong>Name:</strong> ${meeting.location.name}</p>
                        <p><strong>Radius:</strong> ${meeting.location.radius || 100}m</p>
                        <p><strong>Coordinates:</strong> ${meeting.location.latitude?.toFixed(6)}, ${meeting.location.longitude?.toFixed(6)}</p>
                    </div>
                </div>
                
                <div class="mb-4">
                    <h6><i class="fas fa-tools me-2"></i> Attendance Methods</h6>
                    <div class="d-flex gap-2 mt-2">
                        ${methods.map(method => `<span class="badge bg-primary">${method}</span>`).join('')}
                    </div>
                </div>
                
                ${meeting.customFormFields && meeting.customFormFields.length > 0 ? `
                    <div class="mb-4">
                        <h6><i class="fas fa-list-alt me-2"></i> Custom Form Fields</h6>
                        <div class="table-responsive">
                            <table class="table table-sm">
                                <thead>
                                    <tr>
                                        <th>Field</th>
                                        <th>Type</th>
                                        <th>Required</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${meeting.customFormFields.map(field => `
                                        <tr>
                                            <td>${field.label || field.fieldName}</td>
                                            <td><span class="badge bg-secondary">${field.type || 'text'}</span></td>
                                            <td>${field.isRequired ? '<span class="badge bg-danger">Yes</span>' : '<span class="badge bg-secondary">No</span>'}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>
                ` : ''}
            </div>
            
            <div class="col-md-4">
                <div class="share-section">
                    <h6><i class="fas fa-share-alt me-2"></i> Share Meeting</h6>
                    
                    <div class="mt-3">
                        <p class="small text-muted">Meeting Link:</p>
                        <div class="share-link mb-3">
                            ${meeting.links?.attendeeForm ? 
                                `<a href="${meeting.links.attendeeForm}" target="_blank">${meeting.links.attendeeForm}</a>` :
                                '<span class="text-muted">Link not available</span>'
                            }
                        </div>
                        
                        <div class="d-flex gap-2 mb-3">
                            <button class="btn btn-sm btn-primary-custom flex-grow-1" onclick="copyMeetingDetailsLink('${meeting._id}')">
                                <i class="fas fa-copy me-1"></i> Copy Link
                            </button>
                            <button class="btn btn-sm btn-outline-custom" onclick="testMeetingDetailsLink('${meeting._id}')">
                                <i class="fas fa-external-link-alt"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="mt-4 text-center">
                        <h6><i class="fas fa-qrcode me-2"></i> QR Code</h6>
                        <div id="meetingQRCode" class="mt-2 mb-3">
                            ${qrCodeHTML}
                        </div>
                        <button class="btn btn-sm btn-primary-custom w-100" onclick="downloadMeetingQRCode('${meeting._id}')">
                            <i class="fas fa-download me-1"></i> Download QR Code
                        </button>
                    </div>
                    
                    <div class="mt-4">
                        <h6>Access Codes</h6>
                        <div class="mt-2">
                            <p class="mb-1"><small>SMS Code:</small> <code>${meeting.accessCodes?.smsCode || 'N/A'}</code></p>
                            <p class="mb-1"><small>USSD Code:</small> <code>${meeting.accessCodes?.ussdCode || 'N/A'}</code></p>
                            <p class="mb-1"><small>Public Code:</small> <code>${meeting.accessCodes?.publicCode || 'N/A'}</code></p>
                        </div>
                    </div>
                    
                    <div class="mt-4">
                        <h6>Quick Actions</h6>
                        <div class="d-grid gap-2 mt-2">
                            <button class="btn btn-sm btn-outline-primary" onclick="viewMeetingAttendance('${meeting._id}')">
                                <i class="fas fa-users me-1"></i> View Attendance
                            </button>
                            <button class="btn btn-sm btn-outline-success" onclick="exportMeetingReport('${meeting._id}', 'pdf')">
                                <i class="fas fa-file-pdf me-1"></i> Export PDF
                            </button>
                            <button class="btn btn-sm btn-outline-info" onclick="startMeetingNow('${meeting._id}')" ${meeting.status !== 'draft' ? 'disabled' : ''}>
                                <i class="fas fa-play me-1"></i> Start Meeting
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `;
    
    document.getElementById('meetingDetailsContent').innerHTML = content;
    
    const modal = new bootstrap.Modal(document.getElementById('meetingDetailsModal'));
    modal.show();
}

// Helper function to get meeting status badge
function getMeetingStatusBadge(status) {
    const badges = {
        'draft': '<span class="badge bg-secondary">Draft</span>',
        'active': '<span class="badge bg-success">Active</span>',
        'in_progress': '<span class="badge bg-primary">In Progress</span>',
        'completed': '<span class="badge bg-info">Completed</span>',
        'cancelled': '<span class="badge bg-danger">Cancelled</span>'
    };
    return badges[status] || '<span class="badge bg-secondary">Unknown</span>';
}

// Enhanced meeting list loading
async function loadMeetings() {
    try {
        showLoading();
        
        const status = document.getElementById('meetingStatusFilter').value;
        const startDate = document.getElementById('meetingStartDate').value;
        const endDate = document.getElementById('meetingEndDate').value;
        
        let url = `${API_BASE_URL}/organization/meetings/enhanced`;
        const params = new URLSearchParams();
        
        if (status) params.append('status', status);
        if (startDate) params.append('startDate', startDate);
        if (endDate) params.append('endDate', endDate);
        
        if (params.toString()) {
            url += `?${params.toString()}`;
        }
        
        const response = await fetch(url, {
            headers: {
                'Authorization': `Bearer ${authToken}`
            }
        });
        
        if (response.ok) {
            const data = await response.json();
            updateMeetingsTable(data.meetings || []);
            
            // Store meetings for reference
            window.currentMeetings = data.meetings || [];
        } else {
            const error = await response.json();
            showToast(error.error || 'Failed to load meetings', 'error');
            updateMeetingsTable([]);
        }
    } catch (error) {
        console.error('Load meetings error:', error);
        showToast('Failed to load meetings. Please try again.', 'error');
        updateMeetingsTable([]);
    } finally {
        hideLoading();
    }
}

// Enhanced meetings table update
function updateMeetingsTable(meetings) {
    const tbody = document.getElementById('meetingsTable');
    
    if (!meetings || meetings.length === 0) {
        tbody.innerHTML = `
            <tr>
                <td colspan="7" class="text-center py-5">
                    <i class="fas fa-calendar-times fa-3x text-muted mb-3"></i>
                    <h5>No meetings found</h5>
                    <p class="text-muted mb-4">Create your first meeting to get started</p>
                    <button class="btn btn-primary-custom" onclick="showCreateMeetingModal()">
                        <i class="fas fa-plus me-2"></i> Create Meeting
                    </button>
                </td>
            </tr>
        `;
        return;
    }
    
    let html = '';
    
    meetings.forEach(meeting => {
        const startTime = new Date(meeting.schedule.startTime);
        const dateStr = startTime.toLocaleDateString() + ' ' + startTime.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        
        // Get attendance methods
        const methods = [];
        if (meeting.attendanceConfig?.allowedModes?.smartphoneGPS) methods.push('GPS');
        if (meeting.attendanceConfig?.allowedModes?.sms) methods.push('SMS');
        if (meeting.attendanceConfig?.allowedModes?.ussd) methods.push('USSD');
        if (meeting.attendanceConfig?.allowedModes?.kiosk) methods.push('Kiosk');
        if (meeting.attendanceConfig?.allowedModes?.manual) methods.push('Manual');
        
        // Status badge
        const statusBadge = getMeetingStatusBadge(meeting.status);
        
        html += `
            <tr data-meeting-id="${meeting._id}">
                <td>
                    <strong>${meeting.title}</strong>
                    ${meeting.description ? `<br><small class="text-muted">${meeting.description}</small>` : ''}
                </td>
                <td>${dateStr}</td>
                <td>${meeting.location.name}</td>
                <td>
                    <div class="d-flex flex-wrap gap-1">
                        ${methods.map(method => `<span class="badge bg-primary">${method}</span>`).join('')}
                    </div>
                </td>
                <td>${statusBadge}</td>
                <td>${meeting.attendanceCount || 0}</td>
                <td>
                    <div class="meeting-actions">
                        <button class="btn btn-sm btn-outline-primary" onclick="viewMeeting('${meeting._id}')" title="View Details">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="btn btn-sm btn-outline-warning" onclick="editMeeting('${meeting._id}')" 
                                ${meeting.status === 'draft' || meeting.status === 'active' ? '' : 'disabled'} 
                                title="Edit Meeting">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-outline-success" onclick="activateMeeting('${meeting._id}')" 
                                ${meeting.status === 'draft' && meeting.validationStatus?.allSectionsComplete ? '' : 'disabled'} 
                                title="Activate Meeting">
                            <i class="fas fa-play"></i>
                        </button>
                        <button class="btn btn-sm btn-outline-danger" onclick="deleteMeeting('${meeting._id}')" 
                                ${meeting.status === 'draft' || (meeting.attendanceCount === 0) ? '' : 'disabled'} 
                                title="Delete Meeting">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </td>
            </tr>
        `;
    });
    
    tbody.innerHTML = html;
}

// Enhanced meeting activation
async function activateMeeting(meetingId) {
    if (!confirm('Are you sure you want to activate this meeting? This will make it available for attendance.')) {
        return;
    }
    
    try {
        showLoading();
        
        const response = await fetch(`${API_BASE_URL}/meetings/${meetingId}/activate`, {
            method: 'POST',
            headers: {
                'Authorization': `Bearer ${authToken}`
            }
        });
        
        if (response.ok) {
            const result = await response.json();
            showToast('Meeting activated successfully!', 'success');
            
            // Show success modal with sharing options
            if (result.modalData) {
                successMeetingData = result.modalData;
                showSuccessModal(successMeetingData);
            }
            
            // Reload meetings
            loadMeetings();
        } else {
            const error = await response.json();
            showToast(error.error || 'Failed to activate meeting', 'error');
            
            if (error.validationStatus) {
                showValidationErrors(error.validationStatus);
            }
        }
    } catch (error) {
        console.error('Activate meeting error:', error);
        showToast('Failed to activate meeting', 'error');
    } finally {
        hideLoading();
    }
}

// Show validation errors
function showValidationErrors(validationStatus) {
    let errorMessage = 'Please complete the following sections:\n\n';
    
    validationStatus.messages?.forEach((msg, index) => {
        errorMessage += `${index + 1}. ${msg}\n`;
    });
    
    if (validationStatus.sections) {
        Object.entries(validationStatus.sections).forEach(([section, isComplete]) => {
            if (!isComplete) {
                errorMessage += ` ${section.replace(/([A-Z])/g, ' $1').toUpperCase()} section incomplete\n`;
            }
        });
    }
    
    alert(errorMessage);
}

// Enhanced success modal functions
function showSuccessModal(data) {
    // Update modal content with meeting data
    document.getElementById('successMeetingTitle').textContent = data.title;
    
    if (data.shareLinks?.attendeeForm) {
        document.getElementById('successMeetingLink').innerHTML = `
            <a href="${data.shareLinks.attendeeForm}" target="_blank">${data.shareLinks.attendeeForm}</a>
        `;
        successMeetingData.meetingLink = data.shareLinks.attendeeForm;
    }
    
    // Update QR code
    const qrContainer = document.getElementById('successQRCode');
    qrContainer.innerHTML = '';
    
    if (data.qrCode) {
        qrContainer.innerHTML = `<img src="${data.qrCode}" alt="QR Code" class="img-fluid rounded">`;
    } else if (data.shareLinks?.attendeeForm) {
        QRCode.toCanvas(data.shareLinks.attendeeForm, { width: 200, margin: 2 }, function(error, canvas) {
            if (!error) {
                canvas.className = 'img-fluid rounded';
                qrContainer.appendChild(canvas);
                successMeetingData.generatedQRCode = canvas.toDataURL('image/png');
            }
        });
    }
    
    // Update access codes
    document.getElementById('successSmsCode').textContent = data.accessCodes?.smsCode || 'N/A';
    document.getElementById('successUssdCode').textContent = data.accessCodes?.ussdCode || 'N/A';
    document.getElementById('successPublicCode').textContent = data.accessCodes?.publicCode || 'N/A';
    
    // Show modal
    const successModal = new bootstrap.Modal(document.getElementById('successModal'));
    successModal.show();
}

// Helper functions for success modal
function copySuccessLink() {
    if (successMeetingData?.meetingLink) {
        navigator.clipboard.writeText(successMeetingData.meetingLink).then(() => {
            showToast('Meeting link copied to clipboard!', 'success');
        });
    }
}

function downloadSuccessQRCode() {
    if (successMeetingData?.generatedQRCode) {
        const link = document.createElement('a');
        link.href = successMeetingData.generatedQRCode;
        link.download = `qr-code-${successMeetingData.title.replace(/\s+/g, '-').toLowerCase()}.png`;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        showToast('QR code downloaded!', 'success');
    }
}

function shareSuccessViaEmail() {
    if (successMeetingData?.meetingLink) {
        const subject = `Join ${successMeetingData.title}`;
        const body = `You're invited to join ${successMeetingData.title}. Click the link below to join:\n\n${successMeetingData.meetingLink}\n\nOr use these codes:\nSMS: ${successMeetingData.accessCodes.smsCode}\nUSSD: ${successMeetingData.accessCodes.ussdCode}`;
        window.location.href = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
    }
}

function shareSuccessViaWhatsApp() {
    if (successMeetingData?.meetingLink) {
        const text = `Join ${successMeetingData.title}: ${successMeetingData.meetingLink}`;
        window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');
    }
}

function shareSuccessViaSMS() {
    if (successMeetingData?.meetingLink) {
        const body = `Join ${successMeetingData.title}: ${successMeetingData.meetingLink}`;
        window.location.href = `sms:?body=${encodeURIComponent(body)}`;
    }
}

function shareSuccessViaCopy() {
    if (successMeetingData) {
        const text = `Meeting: ${successMeetingData.title}\nLink: ${successMeetingData.meetingLink}\nSMS Code: ${successMeetingData.accessCodes.smsCode}\nUSSD Code: ${successMeetingData.accessCodes.ussdCode}`;
        navigator.clipboard.writeText(text).then(() => {
            showToast('All meeting details copied!', 'success');
        });
    }
}

function goToMeetingDashboard() {
    // Close success modal
    const successModal = bootstrap.Modal.getInstance(document.getElementById('successModal'));
    if (successModal) successModal.hide();
    
    // Navigate to meetings section
    showDashboardSection('meetings');
    
    // Highlight the new meeting
    if (successMeetingData?.meetingId) {
        setTimeout(() => {
            const row = document.querySelector(`[data-meeting-id="${successMeetingData.meetingId}"]`);
            if (row) {
                row.classList.add('table-success');
                setTimeout(() => row.classList.remove('table-success'), 3000);
            }
        }, 500);
    }
}

// Setup create meeting validation
function setupCreateMeetingValidation() {
    // Listen for input changes to update validation state
    const validationElements = [
        'meetingTitle', 'meetingLocationName', 'meetingStartTime', 
        'meetingEndTime', 'meetingLatitude', 'meetingLongitude',
        'allowGPSMeeting', 'allowSMSMeeting', 'allowUSSDMeeting',
        'allowKioskMeeting', 'allowManualMeeting', 'requireForm'
    ];
    
    validationElements.forEach(elementId => {
        const element = document.getElementById(elementId);
        if (element) {
            element.addEventListener('change', updateCreateMeetingButtonState);
            element.addEventListener('input', updateCreateMeetingButtonState);
        }
    });
    
    // Listen for form field changes
    document.addEventListener('formFieldsChanged', updateCreateMeetingButtonState);
}

function updateCreateMeetingButtonState() {
    const createButton = document.querySelector('#createMeetingModal .btn-primary-custom');
    const sections = validateAllMeetingSections();
    
    if (sections.allComplete) {
        createButton.disabled = false;
        createButton.innerHTML = '<i class="fas fa-check-circle me-2"></i> Create Meeting';
    } else {
        createButton.disabled = true;
        createButton.innerHTML = `<i class="fas fa-lock me-2"></i> Complete All Sections (${sections.incompleteSections.length} remaining)`;
    }
}

// Additional helper functions for meeting management
function generateMeetingLinks(meetingId, publicCode) {
    return {
        adminDashboard: `${FRONTEND_URL}/admin/meetings/${meetingId}`,
        attendeeForm: `${FRONTEND_URL}/attend/${publicCode}`,
        qrCodeUrl: `${API_BASE_URL}/meetings/${meetingId}/qrcode`
    };
}

// Initialize form builder
function initializeFormBuilder() {
    currentMeetingFormFields = [];
    
    // Add default form field button
    document.getElementById('addDefaultFieldsBtn')?.addEventListener('click', addDefaultFields);
    
    // Add custom field button
    document.getElementById('addFormFieldBtn')?.addEventListener('click', () => addFormField());
    
    // Clear fields button
    document.getElementById('clearFormFieldsBtn')?.addEventListener('click', clearFormFields);
    
    updateFormPreview();
}

// Add default form fields
function addDefaultFields() {
    // Clear existing fields
    currentMeetingFormFields = [];
    document.getElementById('formFieldsList').innerHTML = '';
    
    // Add default fields
    const defaultFields = [
        { type: 'text', label: 'Full Name', placeholder: 'Enter your full name', required: true },
        { type: 'email', label: 'Email Address', placeholder: 'Enter your email address', required: false },
        { type: 'tel', label: 'Phone Number', placeholder: 'Enter your phone number', required: true },
        { type: 'text', label: 'Employee/Student ID', placeholder: 'Enter your ID number', required: false },
        { type: 'select', label: 'Department', placeholder: 'Select your department', required: false, options: ['IT', 'HR', 'Finance', 'Operations', 'Marketing'] },
        { type: 'textarea', label: 'Comments', placeholder: 'Any additional comments', required: false }
    ];
    
    defaultFields.forEach(field => addFormField(field.type, field.label, field.placeholder, field.required, field.options));
    
    showToast('Default fields added successfully', 'success');
    document.dispatchEvent(new Event('formFieldsChanged'));
}

// Show create meeting modal with proper initialization
function showCreateMeetingModal() {
    // Reset form fields
    currentMeetingFormFields = [];
    document.getElementById('formFieldsList').innerHTML = `
        <div class="alert alert-info">
            No fields added yet. Click "Add Field" to create your first form field.
        </div>
    `;
    updateFormPreview();
    
    // Reset form values
    document.getElementById('createMeetingForm').reset();
    
    // Set default date/time
    const now = new Date();
    const future = new Date(now.getTime() + 24 * 60 * 60 * 1000); // Tomorrow
    
    document.getElementById('meetingStartTime').value = formatDateTimeLocal(future);
    document.getElementById('meetingEndTime').value = formatDateTimeLocal(new Date(future.getTime() + 2 * 60 * 60 * 1000)); // 2 hours later
    
    // Reset sharing section
    document.getElementById('generatedLink').innerHTML = '<span class="text-muted">Link will be generated after meeting creation</span>';
    document.getElementById('qrCodeCanvas').innerHTML = '<p class="text-muted">QR code will appear here</p>';
    
    // Reset button states
    updateCreateMeetingButtonState();
    
    // Reset to first tab
    const firstTab = document.querySelector('#meetingTabs .nav-link');
    if (firstTab) {
        firstTab.click();
    }
    
    // Show modal
    const modal = new bootstrap.Modal(document.getElementById('createMeetingModal'));
    modal.show();
}

// Format date for datetime-local input
function formatDateTimeLocal(date) {
    const year = date.getFullYear();
    const month = String(date.getMonth() + 1).padStart(2, '0');
    const day = String(date.getDate()).padStart(2, '0');
    const hours = String(date.getHours()).padStart(2, '0');
    const minutes = String(date.getMinutes()).padStart(2, '0');
    
    return `${year}-${month}-${day}T${hours}:${minutes}`;
}

// Tab navigation for create meeting modal
function nextTab() {
    const currentTab = document.querySelector('#meetingTabs .nav-link.active');
    const tabs = Array.from(document.querySelectorAll('#meetingTabs .nav-link'));
    const currentIndex = tabs.indexOf(currentTab);
    
    if (currentIndex < tabs.length - 1) {
        // Validate current tab before proceeding
        if (currentIndex === 0) { // Details tab
            if (!validateMeetingDetailsSection()) {
                showToast('Please fill in all required meeting details', 'error');
                return;
            }
        } else if (currentIndex === 1) { // Form builder tab
            const requireForm = document.getElementById('requireForm')?.checked || false;
            if (requireForm && currentMeetingFormFields.length === 0) {
                showToast('Form is required but no fields added. Please add at least one field.', 'error');
                return;
            }
        }
        
        // Show next tab
        const nextTab = tabs[currentIndex + 1];
        const nextTabPane = document.querySelector(nextTab.getAttribute('data-bs-target'));
        
        currentTab.classList.remove('active');
        currentTab.setAttribute('aria-selected', 'false');
        
        nextTab.classList.add('active');
        nextTab.setAttribute('aria-selected', 'true');
        
        // Show next tab content
        document.querySelectorAll('.tab-pane').forEach(pane => {
            pane.classList.remove('show', 'active');
        });
        nextTabPane.classList.add('show', 'active');
    }
}

function prevTab() {
    const currentTab = document.querySelector('#meetingTabs .nav-link.active');
    const tabs = Array.from(document.querySelectorAll('#meetingTabs .nav-link'));
    const currentIndex = tabs.indexOf(currentTab);
    
    if (currentIndex > 0) {
        const prevTab = tabs[currentIndex - 1];
        const prevTabPane = document.querySelector(prevTab.getAttribute('data-bs-target'));
        
        // Show previous tab
        currentTab.classList.remove('active');
        currentTab.setAttribute('aria-selected', 'false');
        
        prevTab.classList.add('active');
        prevTab.setAttribute('aria-selected', 'true');
        
        // Show previous tab content
        document.querySelectorAll('.tab-pane').forEach(pane => {
            pane.classList.remove('show', 'active');
        });
        prevTabPane.classList.add('show', 'active');
    }
}

// Enhanced toast notifications
function showToast(message, type = 'info', duration = 5000) {
    const toastContainer = document.getElementById('toastContainer');
    
    // Create toast
    const toast = document.createElement('div');
    toast.className = 'toast-custom fade-in';
    
    // Set icon and color based on type
    const icons = {
        'success': { icon: 'check-circle', color: '#4cc9f0' },
        'error': { icon: 'exclamation-circle', color: '#f72585' },
        'warning': { icon: 'exclamation-triangle', color: '#f8961e' },
        'info': { icon: 'info-circle', color: '#4361ee' }
    };
    
    const toastConfig = icons[type] || icons.info;
    
    toast.innerHTML = `
        <div class="toast-header-custom">
            <div>
                <i class="fas fa-${toastConfig.icon} me-2" style="color: ${toastConfig.color}"></i>
                <strong>${type.charAt(0).toUpperCase() + type.slice(1)}</strong>
            </div>
            <button type="button" class="btn-close" onclick="this.parentElement.parentElement.remove()"></button>
        </div>
        <div class="toast-body-custom">
            ${message}
        </div>
    `;
    
    toastContainer.appendChild(toast);
    
    // Auto remove after duration
    setTimeout(() => {
        if (toast.parentNode) {
            toast.remove();
        }
    }, duration);
}

// Enhanced loading indicator
function showLoading(message = 'Loading...') {
    const spinner = document.getElementById('loadingSpinner');
    spinner.style.display = 'flex';
    
    // Update loading message if element exists
    const messageElement = spinner.querySelector('.loading-message');
    if (messageElement) {
        messageElement.textContent = message;
    }
}

function hideLoading() {
    document.getElementById('loadingSpinner').style.display = 'none';
}

// Setup real-time updates for live attendance feed
function setupRealTimeUpdates() {
    if (authToken) {
        startLiveFeed();
    }
}

function startLiveFeed() {
    if (liveFeedInterval) {
        clearInterval(liveFeedInterval);
    }
    
    // Update live feed every 10 seconds
    liveFeedInterval = setInterval(() => {
        if (document.getElementById('dashboard-home').style.display !== 'none') {
            updateLiveFeed();
        }
    }, 10000);
    
    // Initial update
    updateLiveFeed();
}

async function updateLiveFeed() {
    try {
        const response = await fetch(`${API_BASE_URL}/dashboard/stats`, {
            headers: {
                'Authorization': `Bearer ${authToken}`
            }
        });
        
        if (response.ok) {
            const data = await response.json();
            
            // Update live stats
            document.getElementById('liveAttendees').textContent = data.summary?.todayAttendance || 0;
            document.getElementById('liveMeetings').textContent = data.summary?.activeMeetings || 0;
            document.getElementById('liveVerified').textContent = data.summary?.totalAttendance || 0;
            
            // Update live feed
            if (data.recentAttendance) {
                updateLiveFeedDisplay(data.recentAttendance);
            }
        }
    } catch (error) {
        console.error('Live feed update error:', error);
    }
}

// Make sure all other existing functions are included...
// [Include all the other functions from the original code that aren't overridden]

// Initialize AOS animations
if (typeof AOS !== 'undefined') {
    AOS.init({
        duration: 800,
        once: true
    });
}

// Set up Bootstrap tooltips
const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
tooltipTriggerList.map(function (tooltipTriggerEl) {
    return new bootstrap.Tooltip(tooltipTriggerEl);
});

// Handle form submissions
document.getElementById('registerForm')?.addEventListener('submit', function(e) {
    e.preventDefault();
    registerUser();
});

document.getElementById('loginForm')?.addEventListener('submit', function(e) {
    e.preventDefault();
    loginUser();
});

// Add this CSS for additional styling
const additionalStyles = `
/* Enhanced form validation */
.form-section {
    padding: 1rem;
    margin-bottom: 1rem;
    border-radius: 8px;
    border: 1px solid #dee2e6;
}

.form-section.valid {
    border-left: 4px solid #28a745;
}

.form-section.invalid {
    border-left: 4px solid #dc3545;
}

/* Meeting table enhancements */
.meeting-actions {
    display: flex;
    gap: 4px;
    flex-wrap: nowrap;
}

.meeting-actions .btn {
    padding: 0.25rem 0.5rem;
    font-size: 0.75rem;
}

/* Success modal animations */
.success-icon {
    animation: bounceIn 0.6s ease;
}

@keyframes bounceIn {
    from {
        opacity: 0;
        transform: scale(0.5);
    }
    to {
        opacity: 1;
        transform: scale(1);
    }
}

/* Required field indicator */
.required-field::after {
    content: " *";
    color: #dc3545;
}

/* Loading message */
.loading-message {
    margin-top: 1rem;
    font-size: 0.9rem;
    color: #6c757d;
}

/* Highlight new meeting */
.highlight-new {
    animation: highlight 2s ease;
}

@keyframes highlight {
    0% { background-color: rgba(76, 201, 240, 0.3); }
    100% { background-color: transparent; }
}
`;

// Add the styles to the document
const styleSheet = document.createElement('style');
styleSheet.textContent = additionalStyles;
document.head.appendChild(styleSheet);
    </script>
</body>
</html>